I"p·
<p>AngularJsë¥¼ rquire.js ë¡œ êµ¬ì„±í•˜ëŠ” ë°©ë²•ì€ ì—¬ëŸ¬ ê°€ì§€ê°€ ë‚˜ì™€ ìˆê³ , ì´ë¥¼ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ë°©ë²•ë„ ì—¬ëŸ¬ê°€ì§€ì´ë‹¤. ê°€ëŠ¥í•œ ì‹¬í”Œí•œ ë°©ë²•ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ AngularJs + require.js ì•±ì„ êµ¬ì„±í•´ ë´¤ë‹¤. ì½”ë“œê°€ ê¸¸ì–´ë³´ì—¬ë„ ë§‰ìƒ ì„¤ëª…ì„ ìœ„í•œ ì£¼ì„ì„ ë‹¤ ì§€ìš°ê³  ë‚˜ë©´ ê·¸ë¦¬ ê¸¸ê±°ë‚˜ ë³µì¡í•˜ì§„ ì•Šë‹¤.</p>

<h2 id="angularjs--requirejs">AngularJs + require.js</h2>
<p>ë¨¼ì € í…ŒìŠ¤íŠ¸ ì´ì „ì— ê¸°ë³¸ êµ¬ì„±ì„ ì‹œì‘í•œë‹¤.</p>

<h3 id="folders--files">folders &amp; files</h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> - js
     + controllers
         * SampleController.js .....í…ŒìŠ¤íŠ¸í•  ì»¨íŠ¸ë¡¤ëŸ¬
     + lib .........................ë¼ì´ë¸ŒëŸ¬ë¦¬ ë””ë ‰í† ë¦¬
         * angular/...
         * angular-ui-router/...
         * requirejs/...
     + app.js ......................angular ëª¨ë“ˆ
     + main.js .....................require.js ì„¤ì •
 - partials ........................ng-route íŒŒíŠ¸
     + sample.html .................ë©”ì¸í˜ì´ì§€
 - index.html
</code></pre></div></div>

<h3 id="indexhtml">index.html</h3>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"ko"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>AngularJs+require.js<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"js/lib/requirejs/require.js"</span> <span class="na">data-main=</span><span class="s">"js/main.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;header&gt;&lt;h1&gt;</span>AngularJs+require.js<span class="nt">&lt;/h1&gt;&lt;/header&gt;</span>
    <span class="nt">&lt;main</span> <span class="na">ui-view</span><span class="nt">&gt;&lt;/main&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">&lt;script src="js/lib/requirejs/require.js" data-main="js/main.js"&gt;&lt;/script&gt;</code>ì— ì£¼ì˜. íŠ¹íˆ data-main ì†ì„±ì´ ì¤‘ìš”í•˜ë‹¤.<br />
<code class="language-plaintext highlighter-rouge">index.html</code> ì—ì„œëŠ” <code class="language-plaintext highlighter-rouge">require.js</code> ë§Œ ë¡œë“œí•˜ê³ , ë©”ì¸ íŒŒì¼ì„ ì§€ì •í•´ì¤€ë‹¤. ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ëª¨ë‘ <code class="language-plaintext highlighter-rouge">main.js</code>ì— ì˜ì¡´ì„± ëª¨ë“ˆë¡œ ì„¤ì •í•´ì„œ ë™ì ìœ¼ë¡œ ë¡œë“œí•œë‹¤.</p>

<h3 id="mainjs">main.js</h3>
<p>require.js ì‘ë™ì„ ìœ„í•œ ê¸°ë³¸ ì„¤ì • íŒŒì¼.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">requirejs</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="c1">//ë‹¤ë¥¸ ìƒëŒ€ê²½ë¡œë“¤ì˜ ë² ì´ìŠ¤ê°€ ë  ê²½ë¡œ. </span>
    <span class="c1">//'js' ë””ë ‰í† ë¦¬ ì•ˆì— jsíŒŒì¼ë“¤ì´ ë‹¤ ë“¤ì–´ìˆìœ¼ë¯€ë¡œ 'js'ë¡œ ì„¤ì •.</span>
    <span class="na">baseUrl</span><span class="p">:</span> <span class="dl">"</span><span class="s2">js</span><span class="dl">"</span><span class="p">,</span>

    <span class="c1">//ì‚¬ìš©í•  ëª¨ë“ˆë“¤</span>
    <span class="c1">//ì´ë¦„ : ìƒëŒ€ ê²½ë¡œ</span>
    <span class="na">paths</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">app</span>         <span class="p">:</span> <span class="dl">"</span><span class="s2">app</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">angular</span>     <span class="p">:</span> <span class="dl">"</span><span class="s2">./lib/angular/angular</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">jquery</span>      <span class="p">:</span> <span class="dl">"</span><span class="s2">./lib/jquery/dist/jquery</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">angular-ui-router</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">./lib/angular-ui-router/release/angular-ui-router</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="na">packages</span><span class="p">:</span> <span class="p">[],</span>

    <span class="c1">//AMDë¥¼ ë”°ë¥´ì§€ ì•ŠëŠ” ëª¨ë“ˆë“¤ì„ AMD í˜•ì‹ìœ¼ë¡œ ë…¸ë©€ë¼ì´ì§• í•´ì¤€ë‹¤.</span>
    <span class="na">shim</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">angular</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">exports</span><span class="p">:</span> <span class="dl">"</span><span class="s2">angular</span><span class="dl">"</span> <span class="c1">//íŒŒë¼ë©”í„°ì— ì£¼ì…ë  ê°ì²´ë‚˜ ë³€ìˆ˜</span>
        <span class="p">},</span>
        <span class="na">jquery</span> <span class="p">:{</span>
            <span class="na">exports</span><span class="p">:</span> <span class="dl">"</span><span class="s2">jQuery</span><span class="dl">"</span>   
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">angular-ui-router</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">deps</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">angular</span><span class="dl">"</span><span class="p">]</span> <span class="c1">//í•´ë‹¹ ëª¨ë“ˆì˜ ì˜ì¡´ì„±</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="appjs">app.js</h3>
<p>ì—¬ê¸°ì„œ angularì˜ ê¸°ë³¸ ëª¨ë“ˆì„ ì •ì˜í•˜ëŠ”ë°, app.jsì—­ì‹œ requireì—ì„œ ì‚¬ìš©ë  ëª¨ë“ˆì´ë¯€ë¡œ AMD(Asynchronous Module Definition) í˜•ì‹ì„ ë”°ë¼ ì‘ì„±ë˜ì–´ì•¼ í•œë‹¤. AMDì— ê´€í•´ì„œëŠ” http://d2.naver.com/helloworld/12864, http://d2.naver.com/helloworld/591319 ë¥¼ ì°¸ê³ .</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//ui-routeë¥¼ ì‚¬ìš©í•  ê²ƒì´ë¯€ë¡œ main.jsì—ì„œ ë¯¸ë¦¬ ì •ì˜í•´ë‘” 'angular-ui-router'ë¥¼ ì˜ì¡´ì„±ì— ì¶”ê°€í•´ì¤€ë‹¤.</span>
<span class="nx">define</span><span class="p">([</span>
    <span class="dl">'</span><span class="s1">angular</span><span class="dl">'</span><span class="p">,</span>             <span class="c1">//ì˜ì¡´ì„± ëª¨ë“ˆ ëª©ë¡</span>
    <span class="dl">'</span><span class="s1">angular-ui-router</span><span class="dl">'</span>
<span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">angular</span><span class="p">){</span>      <span class="c1">//íŒ©í† ë¦¬ í•¨ìˆ˜. ì˜ì¡´ì„± ëª¨ë“ˆì„ íŒŒë¼í‚¤í„°ë¡œ ìˆœì„œëŒ€ë¡œ ë°›ëŠ”ë‹¤.</span>
    <span class="k">return</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">,[</span><span class="dl">'</span><span class="s1">ui.router</span><span class="dl">'</span><span class="p">]);</span> <span class="c1">//ì™¸ë¶€ì— ë…¸ì¶œë  ëª¨ë“ˆì„ ë¦¬í„´í•œë‹¤.</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="controllerssamplecontrollerjs">controllers/SampleController.js</h3>

<p>ì•ì—ì„œ ëª¨ë“ˆë¡œ ë§Œë“  appì„ ì˜ì¡´ì„±ìœ¼ë¡œ ì£¼ì…ë°›ì•„ì„œ appì—ì„œ ì‚¬ìš©í•  controllerë¥¼ ë“±ë¡í•œë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">define</span><span class="p">([</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">app</span><span class="p">){</span>   
    <span class="kd">function</span> <span class="nx">Controller</span><span class="p">(</span><span class="nx">$scope</span><span class="p">){</span>
        <span class="nx">$scope</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">World</span><span class="dl">"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="dl">'</span><span class="s1">SampleController</span><span class="dl">'</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">$scope</span><span class="dl">'</span><span class="p">,</span> <span class="nx">Controller</span><span class="p">]);</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="routejs">route.js</h3>

<p>ng-route ì„¤ì •.<br />
ì—­ì‹œ appì„ ì˜ì¡´ì„±ìœ¼ë¡œ ë°›ì•„ì™€ì„œ app.configì„ í†µí•´ì„œ route ì„¤ì •ì„ í•œë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">define</span><span class="p">([</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">app</span><span class="p">){</span>

    <span class="c1">//ui-route ê´€ë ¨ ì„¤ì •</span>
    <span class="nx">app</span><span class="p">.</span><span class="nx">config</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$urlRouterProvider</span><span class="p">,</span> <span class="nx">$locationProvider</span><span class="p">,</span> <span class="nx">$stateProvider</span><span class="p">)</span> <span class="p">{</span>

        <span class="nx">$locationProvider</span><span class="p">.</span><span class="nx">html5Mode</span><span class="p">({</span>
            <span class="na">enabled</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="na">requireBase</span><span class="p">:</span> <span class="kc">false</span>
        <span class="p">});</span>

        <span class="nx">$urlRouterProvider</span><span class="p">.</span><span class="nx">otherwise</span><span class="p">(</span><span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">);</span>
        
        <span class="nx">$stateProvider</span>
        <span class="p">.</span><span class="nx">state</span><span class="p">(</span><span class="dl">'</span><span class="s1">main</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
            <span class="na">url</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">templateUrl</span><span class="p">:</span> <span class="dl">'</span><span class="s1">partials/main.html</span><span class="dl">'</span><span class="p">,</span> <span class="c1">//`ui-view`ì— ë“¤ì–´ê°ˆ html í…œí”Œë¦¿. í…œí”Œë¦¿ íŒŒì¼ì€ ë’¤ì—ì„œ ì‘ì„±í•œë‹¤.</span>
            <span class="na">controller</span><span class="p">:</span> <span class="dl">'</span><span class="s1">SampleController</span><span class="dl">'</span> 
            <span class="c1">//ì—¬ê¸°ì„œ controllerë¥¼ ì§€ì •í•˜ë ¤ë©´, SampleControllerê°€ appì— ë“±ë¡ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤. ì´ ë‹¤ìŒì— ë‚˜ì˜¤ëŠ” SampleController.jsì—ì„œ ë“±ë¡í•œë‹¤.</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">})</span>
</code></pre></div></div>

<h3 id="partialsmainhtml">partials/main.html</h3>

<p><code class="language-plaintext highlighter-rouge">ui-view</code>ì— ë“¤ì–´ê°ˆ html í…œí”Œë¦¿</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div&gt;</span>
this is main Page.<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>
Hello, {â€‹{name}}!
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<h3 id="bootstraping">Bootstraping</h3>

<p>ì¼ë°˜ì ìœ¼ë¡œëŠ” angualr.jsíŒŒì¼ê³¼ app.jsë¥¼ ë¡œë”©í•˜ë©´ <code class="language-plaintext highlighter-rouge">body</code>ì—  <code class="language-plaintext highlighter-rouge">ng-app</code> ë””ë ‰í‹°ë¸Œë¥¼ ê±¸ê³ , ì´ê±¸ í†µí•´ì„œ AngularJsê°€ ëª¨ë“ˆì„ ë¶€íŠ¸ìŠ¤íŠ¸ë© í•˜ê³  í…œí”Œë¦¿ì„ ì»´íŒŒì¼ í•˜ëŠ”ë°, ì§€ê¸ˆ ì˜ ê²½ìš°, ëª¨ë“ˆë“¤ì„ ë™ì ìœ¼ë¡œ ë¡œë”©í•˜ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">ng-app</code>ì„ ì‚¬ìš©í•˜ë©´ ë¡œë”©ì‹œì ì´ ë§ì§€ ì•Šì•„ ì—ëŸ¬ê°€ ë‚œë‹¤. ë”°ë¼ì„œ ë‹¤ìŒ ì½”ë“œë¥¼ ì´ìš©í•´ì„œ ìˆ˜ë™ìœ¼ë¡œ bootstrapingì„ í•´ì¤˜ì•¼ í•œë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">angular</span><span class="p">.</span><span class="nx">bootstrap</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">]);</span>
</code></pre></div></div>

<p>ì´ ì½”ë“œë¥¼ ì–¸ì œ, ì–´ë””ì—ì„œ ì‹¤í–‰í•  ì§€ ì •í•˜ê¸° ì „ì— ì ê¹ ì •ë¦¬ë¥¼ í•´ë³´ë©´ js íŒŒì¼ì„ 4ê°œ ë§Œë“¤ì—ˆëŠ”ë°, ê°ê° ì—­í• ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ul>
  <li>main       : require ì„¤ì •. ë¼ì´ë¸ŒëŸ¬ë¦¬ë“± ì˜ì¡´ì„± ëª¨ë“ˆë“¤ì„ ë“±ë¡.</li>
  <li>app        : ì•µê·¤ëŸ¬ ëª¨ë“ˆì •ì˜</li>
  <li>controller : ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ëª¨ë“ˆì— ë“±ë¡</li>
  <li>route      : ëª¨ë“ˆì— route ì„¤ì •. ë“±ë¡ëœ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ routeì— í• ë‹¹í•¨.</li>
</ul>

<p>ì—¬ê¸°ì„œ í•œê°€ì§€ ì§šê³  ë„˜ì–´ê°ˆ ê²ƒì€, route.jsì—ì„œ <code class="language-plaintext highlighter-rouge">app.config</code>ì— ë„˜ê¸´ ì„¤ì •ì„ ë‹´ë‹¹í•˜ëŠ” ì½œë°± í•¨ìˆ˜ëŠ” bootstrap ì‹œì ì—ì„œ ì‹¤í–‰ëœë‹¤ëŠ” ê²ƒì´ë‹¤. ê·¸ëŸ¬ë¯€ë¡œ bootstrap í•˜ê¸° ì´ì „ì— ë¯¸ë¦¬ app.configì„ ì‹¤í–‰í•´ ë‘ì–´ì•¼ bootstrapí•  ë•Œ ì œëŒ€ë¡œ ì‹¤í–‰ëœë‹¤. ê·¸ë¦¬ê³  ë°©ê¸ˆ ë§í•œ callback í•¨ìˆ˜ì—ì„œ controllerë¥¼ urlì— ë§¤í•‘í•˜ë¯€ë¡œ controllerë“±ë¡ë„ bootstrap í•˜ê¸° ì´ì „ì—ë§Œ í•˜ë©´ ëœë‹¤. (route.jsë³´ë‹¤ëŠ” ë¹ ë¥´ë“  ëŠ¦ë“  ìƒê´€ ì—†ë‹¤. route.js ì‹¤í–‰ì‹œì ì— controllerë“¤ì„ ë°”ë¡œ ì°¸ì¡°í•´ì„œ ë§¤í•‘í•˜ëŠ”ê²ƒì´ ì•„ë‹ˆë¼ ì½œë°±í•¨ìˆ˜ë§Œ ë„˜ê¸°ê¸° ë•Œë¬¸ì´ë‹¤.) ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìœ„ ì½”ë“œë“¤ì˜ ì˜¬ë°”ë¥¸ ì‹¤í–‰ ìˆœì„œë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì‹¤í–‰ë˜ì–´ì•¼ ë§ì„ ê²ƒì´ë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>main -&gt; app -&gt; (controller, route) -&gt; bootstrap
</code></pre></div></div>
<p>í˜„ì¬ ìƒíƒœë¥¼ ë³´ë©´ ì‹¤ì œë¡œ ì‹¤í–‰ë˜ëŠ” ê²ƒì€ main.jsë¿ì´ë‹¤. require.jsê°€ ë¡œë“œí•˜ë„ë¡ <code class="language-plaintext highlighter-rouge">data-main</code>ì— ì§€ì •í•´ë‘ì—ˆìœ¼ë¯€ë¡œ ê°€ì¥ ë¨¼ì € ì‹¤í–‰ì´ ë  ê²ƒì´ë‹¤. ê·¸ë¦¬ê³  appì€ controllerì™€ routeì— ì˜ì¡´ì„± ì„¤ì •ì„ í•´ë‘ì—ˆìœ¼ë¯€ë¡œ controllerë‚˜ routeê°€ ì‹¤í–‰ë˜ë©´ ì‹¤í–‰ ë˜ë„ë¡ ë˜ì–´ ìˆë‹¤. bootstrapingì„ í•˜ë ¤ë©´ ì´ ëª¨ë“  ëª¨ë“ˆì´ ë¡œë”© ë˜ì–´ ìˆì–´ì•¼ í•˜ë¯€ë¡œ, í•„ìš”í•œ ì˜ì¡´ì„± ëª¨ë“ˆì„ ì£¼ì… ë°›ì•„ì„œ ë‹¤ìŒê³¼ ê°™ì´ ì‹¤í–‰í•˜ë©´ ëœë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">requirejs</span><span class="p">([</span>
    <span class="dl">'</span><span class="s1">angular</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">route</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">./controllers/SampleController</span><span class="dl">'</span>
<span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">angular</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">angular</span><span class="p">.</span><span class="nx">bootstrap</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">]);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>ìœ„ì˜ ë‚´ìš©ì€, require.jsê°€ main.jsë¥¼ ë™ì ìœ¼ë¡œ ë¡œë”©í•´ì„œ configë¥¼ ì‹¤í–‰í•œ ì´í›„ì— ì‹¤í–‰ë˜ì–´ì•¼ í•˜ë¯€ë¡œ <code class="language-plaintext highlighter-rouge">main.js</code>ì˜ config ë’¤ìª½ì— ë„£ì–´ì¤€ë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*main.js*/</span>
<span class="nx">requirejs</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
    <span class="na">baseUrl</span><span class="p">:</span> <span class="dl">"</span><span class="s2">js</span><span class="dl">"</span><span class="p">,</span>
    <span class="na">paths</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">app</span>         <span class="p">:</span> <span class="dl">"</span><span class="s2">app</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">route</span>       <span class="p">:</span> <span class="dl">"</span><span class="s2">route</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">angular</span>     <span class="p">:</span> <span class="dl">"</span><span class="s2">./lib/angular/angular</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">jquery</span>      <span class="p">:</span> <span class="dl">"</span><span class="s2">./lib/jquery/dist/jquery</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">angular-ui-router</span><span class="dl">"</span> <span class="p">:</span> <span class="dl">"</span><span class="s2">./lib/angular-ui-router/release/angular-ui-router</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="na">packages</span><span class="p">:</span> <span class="p">[],</span>
    <span class="na">shim</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">angular</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">exports</span><span class="p">:</span> <span class="dl">"</span><span class="s2">angular</span><span class="dl">"</span>
        <span class="p">},</span>
        <span class="na">jquery</span> <span class="p">:{</span>
            <span class="na">exports</span><span class="p">:</span> <span class="dl">"</span><span class="s2">jQuery</span><span class="dl">"</span>   
        <span class="p">},</span>
        <span class="dl">"</span><span class="s2">angular-ui-router</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">deps</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">angular</span><span class="dl">"</span><span class="p">]</span>
        <span class="p">},</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">requirejs</span><span class="p">([</span>
    <span class="dl">'</span><span class="s1">angular</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">route</span><span class="dl">'</span><span class="p">,</span>
    <span class="dl">'</span><span class="s1">./controllers/SampleController</span><span class="dl">'</span>
<span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">angular</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">angular</span><span class="p">.</span><span class="nx">bootstrap</span><span class="p">(</span><span class="nb">document</span><span class="p">,</span> <span class="p">[</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">]);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>ì¼ë‹¨ ì´ì™€ ê°™ì´ ì™„ë£Œí•˜ê³  ê°„ë‹¨í•œ ì„œë²„ë¥¼ êµ¬ë™ì‹œí‚¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì‘ë™í•˜ëŠ” angularJS appì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>python <span class="nt">-m</span> SimpleHTTPServer
</code></pre></div></div>

<p><img src="http://i.imgur.com/N0AuNrG.png" alt="Imgur" /></p>

<h2 id="setting-karma">Setting Karma</h2>
<p>angularJS + require.js ë¥¼ ì‚¬ìš©í•œ ì•± êµ¬ì„±ì€ ì •ë¦¬ê°€ ë˜ì—ˆë‹¤. ì´ì œ ì´ê±¸ ë°”íƒ•ìœ¼ë¡œ karma testë¥¼ ì„¤ì •í•´ ë³´ì.</p>

<h3 id="ì„¤ì¹˜">ì„¤ì¹˜</h3>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npm init <span class="c">#enterë¥¼ ì—°ì†ìœ¼ë¡œ ì³ì„œ ì„¤ì • ì™„ë£Œ</span>

<span class="nv">$ </span>npm <span class="nb">install</span> <span class="nt">-g</span> jasmine
<span class="nv">$ </span>npm <span class="nb">install</span> <span class="nt">-g</span> karma-cli
<span class="nv">$ </span>npm <span class="nb">install</span> <span class="nt">-g</span> phantomjs
<span class="nv">$ </span>npm <span class="nb">install </span>karma <span class="nt">--save-dev</span>
<span class="nv">$ </span>npm <span class="nb">install </span>karma-jasmine@2_0 <span class="nt">--save-dev</span>
<span class="nv">$ </span>npm <span class="nb">install </span>karma-phantomjs-launcher <span class="nt">--save-dev</span>

<span class="nv">$ </span>bower <span class="nb">install </span>angular-mocks
</code></pre></div></div>

<h3 id="ì„¤ì •">ì„¤ì •</h3>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>karma init <span class="c">#ì•„ë˜ ì˜µì…˜ ì„¤ì •ì— ì£¼ì˜</span>

<span class="c">#Do you want to use Require.js ?</span>
<span class="c">#&gt; yes</span>

<span class="c">#Do you wanna generate a bootstrap file for RequireJS?</span>
<span class="c">#&gt; yes</span>
</code></pre></div></div>

<p>karma.conf.js íŒŒì¼ê³¼  â€˜bootstrap file for RequireJSâ€™, ì¦‰ test-main.js íŒŒì¼ì´ ë§Œë“¤ì–´ ì¡Œë‹¤. ì„¸ë¶€ì ìœ¼ë¡œ ì„¤ì •ì„ ì¡°ì •í•˜ì.</p>

<h3 id="karmaconfjs">karma.conf.js</h3>
<p>ì£¼ì„ë¶€ë¶„ì„ ì‚­ì œí•˜ê³  ë‚˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤. ìˆ˜ì •í•  ë¶€ë¶„ì€ <code class="language-plaintext highlighter-rouge">basePath</code>, <code class="language-plaintext highlighter-rouge">files</code> ë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">config</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">config</span><span class="p">.</span><span class="kd">set</span><span class="p">({</span>
    <span class="na">basePath</span><span class="p">:</span> <span class="dl">'</span><span class="s1">js</span><span class="dl">'</span><span class="p">,</span> <span class="c1">//ëª¨ë“  ì„¤ì •ì˜ ìƒëŒ€ê²½ë¡œ ê¸°ì¤€ì´ ë  ê²½ë¡œì´ë‹¤.</span>
    <span class="na">frameworks</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">jasmine</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">requirejs</span><span class="dl">'</span><span class="p">],</span>
    <span class="na">files</span><span class="p">:</span> <span class="p">[</span>
      <span class="dl">'</span><span class="s1">test-main.js</span><span class="dl">'</span><span class="p">,</span> <span class="c1">//í…ŒìŠ¤íŠ¸ì— ì§ì ‘ ì‚¬ìš©ë  íŒŒì¼</span>
      <span class="p">{</span><span class="na">pattern</span><span class="p">:</span> <span class="dl">'</span><span class="s1">**/*.js</span><span class="dl">'</span><span class="p">,</span> <span class="na">included</span><span class="p">:</span> <span class="kc">false</span><span class="p">}</span> <span class="c1">//ì„œë²„ì—ì„œ ì œê³µë§Œ í•  íŒŒì¼</span>
    <span class="p">],</span>
    <span class="na">exclude</span><span class="p">:</span> <span class="p">[],</span>
    <span class="na">preprocessors</span><span class="p">:</span> <span class="p">{},</span>
    <span class="na">reporters</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">progress</span><span class="dl">'</span><span class="p">],</span>
    <span class="na">port</span><span class="p">:</span> <span class="mi">9876</span><span class="p">,</span>
    <span class="na">colors</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">logLevel</span><span class="p">:</span> <span class="nx">config</span><span class="p">.</span><span class="nx">LOG_INFO</span><span class="p">,</span>
    <span class="na">autoWatch</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">browsers</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">PhantomJS</span><span class="dl">'</span><span class="p">],</span>
    <span class="na">singleRun</span><span class="p">:</span> <span class="kc">false</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre></div></div>

<p>files ì˜µì…˜ì„ ìì„¸íˆ ë³¼ í•„ìš”ê°€ ìˆëŠ”ë°, ì—¬ê¸°ì— ë‹¨ìˆœíˆ ì¶”ê°€ëœ ê²½ë¡œëŠ” í…ŒìŠ¤íŠ¸í• ë•Œ ë¸Œë¼ìš°ì €ì— <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> íƒœê·¸ë¡œ ì§ì ‘ ì½”ë“œê°€ ì‚½ì…ë˜ì–´ ë¡œë”© ë˜ì§€ë§Œ <code class="language-plaintext highlighter-rouge">included:false</code> ì˜µì…˜ì„ ì¶”ê°€í•˜ê²Œ ë˜ë©´ ì„œë²„ì—ì„œ serve í•˜ê¸°ë§Œ í•˜ê³  ì§ì ‘ ì‚½ì… í•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. ì´ë ‡ê²Œ í•˜ëŠ” ì´ìœ ëŠ” <code class="language-plaintext highlighter-rouge">test-main.js</code> íŒŒì¼ë§Œ í…ŒìŠ¤íŠ¸ì— ì§ì ‘ ì‚½ì…í•˜ê³ , library ë“± ë‹¤ë¥¸ ì˜ì¡´ì„± íŒŒì¼ë“¤ì„ <code class="language-plaintext highlighter-rouge">test-main.js</code> ì—ì„œ ë™ì ìœ¼ë¡œ ì‚½ì…í•  ê²ƒì´ê¸° ë•Œë¬¸ì´ë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">basepath</code>ë¥¼ <code class="language-plaintext highlighter-rouge">js</code>ë¡œ ì„¤ì •í–ˆìœ¼ë¯€ë¡œ test-main.jsë¥¼ js í´ë”ë¡œ ì´ë™ì‹œí‚¨ë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mv </span>test-main.js js
</code></pre></div></div>

<h3 id="jstest-mainjs">js/test-main.js</h3>

<p>ì´ íŒŒì¼ì„ ì—´ì–´ë³´ë©´ ì•ì„œ ë§Œë“¤ì—ˆë˜, main.jsì™€ í¡ì‚¬í•œ êµ¬ì„±ì„ ê°€ì§€ê³  ìˆë‹¤. ì¦‰ karma testì‹œì— ì‚¬ìš©ë˜ëŠ” main íŒŒì¼ì´ë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">//ì•ë¶€ë¶„ì€ í…ŒìŠ¤íŠ¸ íŒŒì¼ì„ ëª¨ë‘ ê°€ì ¸ì™€ì„œ allTestFilesë¼ëŠ” ë°°ì—´ì— ë„£ëŠ” ë¶€ë¶„ì´ë‹¤.</span>
<span class="c1">//TEST_REGEXPë¥¼ ë³´ë©´ **/*spec.js, **/*test.js íŒŒì¼ë“¤ì„ ë¡œë”©í•˜ê²Œ ë˜ì–´ ìˆë‹¤.</span>

<span class="kd">var</span> <span class="nx">allTestFiles</span> <span class="o">=</span> <span class="p">[];</span>
<span class="kd">var</span> <span class="nx">TEST_REGEXP</span> <span class="o">=</span> <span class="sr">/</span><span class="se">(</span><span class="sr">spec|test</span><span class="se">)\.</span><span class="sr">js$/i</span><span class="p">;</span> <span class="c1">//ë‹¤ë¥¸ í˜•ì‹ì„ ì›í•˜ë©´ ì´ ë¶€ë¶„ì˜ ì •ê·œí‘œí˜„ì‹ì„ ë³€ê²½í•˜ë©´ ëœë‹¤.</span>

<span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">__karma__</span><span class="p">.</span><span class="nx">files</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">file</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">TEST_REGEXP</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">file</span><span class="p">))</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">normalizedTestModule</span> <span class="o">=</span> <span class="nx">file</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^</span><span class="se">\/</span><span class="sr">base</span><span class="se">\/</span><span class="sr">|</span><span class="se">\.</span><span class="sr">js$/g</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span>
    <span class="nx">allTestFiles</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">normalizedTestModule</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">});</span>


<span class="c1">//ì•ì„œ main.jsì—ì„œ í–ˆë˜ ì„¤ì •ê³¼ ìœ ì‚¬í•˜ê²Œ require.js ì„¤ì •ì„ ìˆ˜í–‰í•œë‹¤.</span>
<span class="nx">require</span><span class="p">.</span><span class="nx">config</span><span class="p">({</span>
  
  <span class="na">baseUrl</span><span class="p">:</span> <span class="dl">'</span><span class="s1">/base</span><span class="dl">'</span><span class="p">,</span> <span class="c1">//karma.conf.jsì—ì„œ basePathë¡œ ì„¤ì •í•œ Pathì˜, ì„œë²„ì—ì„œì˜ ì£¼ì†Œì´ë‹¤.</span>
  <span class="na">deps</span><span class="p">:</span> <span class="nx">allTestFiles</span><span class="p">,</span> <span class="c1">//ì•ì—ì„œ ë§Œë“  allTestFiles ë¥¼ ë¡œë”©í•˜ëŠ” ë¶€ë¶„</span>
  <span class="na">callback</span><span class="p">:</span> <span class="nb">window</span><span class="p">.</span><span class="nx">__karma__</span><span class="p">.</span><span class="nx">start</span><span class="p">,</span>

  <span class="c1">//í…ŒìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©í•  ì˜ì¡´ì„±ì„ ì„¤ì •í•œë‹¤.</span>
  <span class="na">paths</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">angular</span><span class="p">:</span> <span class="dl">"</span><span class="s2">lib/angular/angular</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">angular-mocks</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">lib/angular-mocks/angular-mocks</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">shim</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">angular</span><span class="p">:</span> <span class="p">{</span> <span class="na">exports</span><span class="p">:</span> <span class="dl">'</span><span class="s1">angular</span><span class="dl">'</span> <span class="p">},</span>
    <span class="na">jquery</span><span class="p">:</span> <span class="p">{</span> <span class="na">exports</span><span class="p">:</span> <span class="dl">'</span><span class="s1">jQuery</span><span class="dl">'</span> <span class="p">},</span>
    <span class="dl">"</span><span class="s2">angular-mocks</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span> <span class="na">deps</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">angular</span><span class="dl">'</span><span class="p">]</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<h3 id="jscontrollerssamplecontrollerspecjs">js/Controllers/SampleController.spec.js</h3>

<p>ì—¬ê¸°ì„œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì—­ì‹œ require.js ì— ì˜í•´ì„œ ì£¼ì…ë˜ëŠ” ëª¨ë“ˆì´ë¯€ë¡œ, AMD í‘œì¤€ì— ë§ì¶”ì–´ ì‘ì„±í•œë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//í•„ìš”í•œ "AMD"ì˜ì¡´ì„±ì„ ì£¼ì…ë°›ëŠ”ë‹¤.</span>
<span class="nx">define</span><span class="p">([</span><span class="dl">'</span><span class="s1">./SampleController</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">angular</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">angular-mocks</span><span class="dl">'</span><span class="p">],</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">SampleController</span><span class="p">)</span> <span class="p">{</span>

    <span class="c1">//test code ì‹œì‘</span>
    <span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">SampleController</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">ctrl</span><span class="p">,</span> <span class="nx">scope</span><span class="p">;</span>
      
      <span class="c1">//ê°ê° í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ê¸° ì „ì— í•„ìš”í•œ "angularëª¨ë“ˆ"ë“¤ì„ ì£¼ì…ë°›ëŠ”ë‹¤.</span>
      <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">inject</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$controller</span><span class="p">,</span> <span class="nx">$rootScope</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">scope</span> <span class="o">=</span> <span class="nx">$rootScope</span><span class="p">.</span><span class="nx">$new</span><span class="p">();</span> <span class="c1">//ë§¤ë²ˆ ìƒˆë¡œìš´ scopeì—ì„œ ê¹”ë”í•˜ê²Œ í…ŒìŠ¤íŠ¸</span>
        <span class="nx">ctrl</span> <span class="o">=</span> <span class="nx">$controller</span><span class="p">(</span><span class="nx">SampleController</span><span class="p">,</span> <span class="p">{</span><span class="na">$scope</span><span class="p">:</span> <span class="nx">scope</span><span class="p">});</span> <span class="c1">//ë°©ê¸ˆ ìƒì„±í•œ scope ê¸°ë°˜ìœ¼ë¡œ controllerë¥¼ mockingí•œë‹¤.</span>
      <span class="p">}));</span>

      <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">has default name "World"</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">expect</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">name</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="dl">"</span><span class="s2">World</span><span class="dl">"</span><span class="p">);</span> <span class="c1">//beforeEachì—ì„œ ìƒì„±í•œ scopeì— ëŒ€í•´ì„œ controllerê°€ ì œëŒ€ë¡œ ì‘ë™í–ˆëŠ”ì§€ test.</span>
      <span class="p">});</span>
    <span class="p">});</span>
  <span class="p">});</span>
</code></pre></div></div>

<h3 id="test-ì‹¤í–‰">Test ì‹¤í–‰</h3>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>karma start
</code></pre></div></div>

<p>ì•„ë˜ì™€ ê°™ì´ success ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ë©´ ì„±ê³µì´ë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>04 09 2015 16:08:13.058:WARN <span class="o">[</span>karma]: No captured browser, open http://localhost:9876/
04 09 2015 16:08:13.069:INFO <span class="o">[</span>karma]: Karma v0.13.9 server started at http://localhost:9876/
04 09 2015 16:08:13.076:INFO <span class="o">[</span>launcher]: Starting browser PhantomJS
04 09 2015 16:08:14.332:INFO <span class="o">[</span>PhantomJS 1.9.8 <span class="o">(</span>Mac OS X 0.0.0<span class="o">)]</span>: Connected on socket wUYW1RIdLF6EYQjBAAAA with <span class="nb">id </span>17804098
PhantomJS 1.9.8 <span class="o">(</span>Mac OS X 0.0.0<span class="o">)</span>: Executed 1 of 1 SUCCESS <span class="o">(</span>0.004 secs / 0.008 secs<span class="o">)</span>
</code></pre></div></div>

<h2 id="adding--testing-directive">Adding &amp; Testing Directive</h2>

<p>Controllerì™€ ë§ˆì°¬ê°€ì§€ë¡œ directiveë„ require.js ë¡œ ì£¼ì…ë˜ëŠ” AMD ëª¨ë“ˆë¡œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
ë§Œë“¤ directiveëŠ” name ì´ë¼ëŠ” attributeë¡œ ê°’ì„ ì „ë‹¬ë°›ì•„ì„œ ì¸ì‚¬ë¥¼ í•˜ëŠ” element directiveë‹¤.</p>

<p>ì´ë²ˆì—ëŠ” testì½”ë“œë¥¼ ë¨¼ì € ì‘ì„±í•´ë³´ì. ì¼ë‹¨ ë¹ˆ directiveë¥¼ ë“±ë¡í•˜ëŠ” AMDë¥¼ ë§Œë“¤ì. ì•ì˜ Samplecontrollerì™€ ìœ ì‚¬í•˜ë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*js/directives/SampleDirective.js*/</span>
<span class="nx">define</span><span class="p">([</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">app</span><span class="p">){</span>
  <span class="kd">function</span> <span class="nx">sampleDirective</span><span class="p">(){</span>
    <span class="k">return</span> <span class="p">{};</span>
  <span class="p">}</span>

  <span class="nx">app</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="dl">'</span><span class="s1">sampleDirective</span><span class="dl">'</span><span class="p">,</span> <span class="nx">sampleDirective</span><span class="p">);</span>
  
  <span class="k">return</span> <span class="nx">sampleDirective</span><span class="p">;</span>
<span class="p">});</span>
</code></pre></div></div>

<p>test code</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*js/directives/SampleDirective.spec.js*/</span>

<span class="c1">//directiveì™€ í•„ìš”í•œ AMDë¥¼ ë¡œë“œ</span>
<span class="nx">define</span><span class="p">([</span><span class="dl">'</span><span class="s1">./sampleDirective</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">angular</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">angular-mocks</span><span class="dl">'</span><span class="p">],</span>
<span class="kd">function</span><span class="p">(</span><span class="nx">sampleDirective</span><span class="p">)</span> <span class="p">{</span>

  <span class="nx">describe</span><span class="p">(</span><span class="dl">'</span><span class="s1">sampleDirective</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">//í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•  ì „ì—­ë³€ìˆ˜</span>
    <span class="kd">var</span> <span class="nx">$compile</span><span class="p">,</span> <span class="nx">$rootScope</span><span class="p">,</span> <span class="nx">element</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">World</span><span class="dl">'</span><span class="p">;</span>

    <span class="c1">//directiveë¥¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œëŠ” htmlì„ compileí•´ì•¼ í•˜ë¯€ë¡œ moduleì´ í•„ìš”í•˜ë‹¤.</span>
    <span class="c1">//app.jsëŠ” test-main.jsì— ë“±ë¡ì´ ë˜ì–´ìˆê³ , SampleDirectiveì— ì˜ì¡´ì„±ìœ¼ë¡œ ì„¤ì •í–ˆìœ¼ë¯€ë¡œ  </span>
    <span class="c1">//ì´ë¯¸ ë¡œë“œë˜ì–´ìˆë‹¤. ng-mock.moduleë¡œ mockingí•  ìˆ˜ ìˆë‹¤.</span>
    <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">module</span><span class="p">(</span><span class="dl">"</span><span class="s2">app</span><span class="dl">"</span><span class="p">));</span> 

    <span class="c1">//injectë¡œ angular ëª¨ë“ˆì„ ì£¼ì…ë°›ì„ ë•Œ, ë‚˜ì¤‘ì— ì§‘ì–´ë„£ì„ ë³€ìˆ˜ì´ë¦„ì„ ì§“ê¸° ìš©ì´í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œ</span>
    <span class="c1">//ì•ë’¤ë¡œ _ë¥¼ ë¶™ì—¬ì„œ ì£¼ì…ë°›ì„ ìˆ˜ ìˆë‹¤.(ìë™ìœ¼ë¡œ _ë¥¼ ì œê±°í•´ì„œ ëª¨ë“ˆì„ ì£¼ì…í•´ì¤€ë‹¤.)</span>
    <span class="nx">beforeEach</span><span class="p">(</span><span class="nx">inject</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span><span class="nx">_$compile_</span><span class="p">,</span> <span class="nx">_$rootScope_</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">//ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì´ ì €ì¥í•  ë³€ìˆ˜ëª…ì„ ì¢€ë” í¸í•˜ê²Œ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</span>
      <span class="nx">$compile</span> <span class="o">=</span> <span class="nx">_$compile_</span><span class="p">;</span>
      <span class="nx">$rootScope</span> <span class="o">=</span> <span class="nx">_$rootScope_</span><span class="p">;</span>

      <span class="c1">//ë§¤ í…ŒìŠ¤íŠ¸ í•˜ê¸° ì „ë§ˆë‹¤ htmlì„ compileí•˜ê³  scopeë¥¼ digestí•´ì¤€ë‹¤.</span>
      <span class="nx">element</span> <span class="o">=</span> <span class="nx">$compile</span><span class="p">(</span><span class="dl">'</span><span class="s1">&lt;sample-directive name="</span><span class="dl">'</span><span class="o">+</span><span class="nx">name</span><span class="o">+</span><span class="dl">'</span><span class="s1">"&gt;&lt;/sample-directive&gt;</span><span class="dl">'</span><span class="p">)(</span><span class="nx">$rootScope</span><span class="p">);</span>
      <span class="nx">$rootScope</span><span class="p">.</span><span class="nx">$digest</span><span class="p">();</span>
    <span class="p">}));</span>

    <span class="c1">//directiveê°€ ì˜ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•œë‹¤.</span>
    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">gets attr value</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">expect</span><span class="p">(</span><span class="nx">$rootScope</span><span class="p">.</span><span class="nx">name</span><span class="p">).</span><span class="nx">toBe</span><span class="p">(</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">it</span><span class="p">(</span><span class="dl">'</span><span class="s1">compile template correctly</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">expect</span><span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">html</span><span class="p">()).</span><span class="nx">toContain</span><span class="p">(</span><span class="dl">"</span><span class="s2">Hello, </span><span class="dl">"</span><span class="o">+</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">});</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">karma start</code>ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•´ë³´ë©´</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PhantomJS 1.9.8 <span class="o">(</span>Mac OS X 0.0.0<span class="o">)</span> sampleDirective compile template correctly FAILED
  Expected <span class="s1">''</span> to contain <span class="s1">'Hello, World'</span><span class="nb">.</span>
  Error: Expected <span class="s1">''</span> to contain <span class="s1">'Hello, World'</span><span class="nb">.</span>

  ...

PhantomJS 1.9.8 <span class="o">(</span>Mac OS X 0.0.0<span class="o">)</span>: Executed 3 of 3 <span class="o">(</span>2 FAILED<span class="o">)</span> <span class="o">(</span>0.005 secs / 0.02 secs<span class="o">)</span>
</code></pre></div></div>

<p>í†µê³¼í•˜ì§€ ëª»í•œë‹¤. <code class="language-plaintext highlighter-rouge">ctrl-c</code> ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ <strong>ì¢…ë£Œí•˜ì§€ ë§ê³ </strong> ë³„ë„ì˜ ì—ë””í„°ë¡œ í…ŒìŠ¤íŠ¸ì— ë§ë„ë¡ ë””ë ‰í‹°ë¸Œ ë¡œì§ì„ ì‘ì„±í•œë‹¤.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
  <span class="dl">'</span><span class="s1">use strict</span><span class="dl">'</span><span class="p">;</span>
  <span class="nx">define</span><span class="p">([</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">],</span><span class="kd">function</span><span class="p">(</span><span class="nx">app</span><span class="p">){</span>
    <span class="kd">function</span> <span class="nx">sampleDirective</span><span class="p">(){</span>
      <span class="k">return</span> <span class="p">{</span>
        <span class="na">restrict</span><span class="p">:</span> <span class="dl">'</span><span class="s1">E</span><span class="dl">'</span><span class="p">,</span> <span class="c1">//element directive</span>
        <span class="na">template</span><span class="p">:</span> <span class="dl">'</span><span class="s1">Hello, {â€‹{name}}!</span><span class="dl">'</span><span class="p">,</span> <span class="c1">//scopeì˜ nameì—ê²Œ ì¸ì‚¬í•˜ëŠ” ë‚´ìš©ì„ ì§‘ì–´ë„£ëŠ”ë‹¤.</span>
        <span class="na">link</span><span class="p">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attr</span><span class="p">){</span>
          <span class="nx">scope</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">attr</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span> <span class="c1">// name attrì„ ë°›ì•„ì„œ scopeì— ë„£ëŠ”ë‹¤.</span>
        <span class="p">}</span>
      <span class="p">};</span>
      
    <span class="p">}</span>

    <span class="nx">app</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="dl">'</span><span class="s1">sampleDirective</span><span class="dl">'</span><span class="p">,</span> <span class="nx">sampleDirective</span><span class="p">);</span>
    
    <span class="k">return</span> <span class="nx">sampleDirective</span><span class="p">;</span>
  <span class="p">});</span>
<span class="p">})();</span>
</code></pre></div></div>

<p>ë‹¤ ì‘ì„±í•˜ê³  íŒŒì¼ì„ ì €ì¥í•˜ë©´ karmaê°€ íŒŒì¼ì„ watchí•˜ê³  ìˆë‹¤ê°€ ìë™ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ì¬ìˆ˜í–‰ í•´ì¤€ë‹¤.<br />
(karma.conf.jsì˜ <code class="language-plaintext highlighter-rouge">autoWatch: true</code> ì„¤ì •) <br />
ë¡œì§ì„ ì œëŒ€ë¡œ ì‘ì„±í–ˆë‹¤ë©´, ë‹¤ìŒê³¼ ê°™ì´ success ë©”ì‹œì§€ê°€ ëœ¬ë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PhantomJS 1.9.8 <span class="o">(</span>Mac OS X 0.0.0<span class="o">)</span>: Executed 3 of 3 SUCCESS <span class="o">(</span>0.001 secs / 0.021 secs<span class="o">)</span>
</code></pre></div></div>

:ET