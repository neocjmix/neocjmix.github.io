I"¼¹<h2 id="tldr">TL;DR</h2>

<p><a href="/2020/09/30/AWS-WebRTC(1)">ì´ì „ í¬ìŠ¤íŒ…</a>ì—ì„œ ì´ì–´ì§„ë‹¤.</p>

<p><a href="https://github.com/neocjmix/WebRTC/tree/p2p-%ED%99%94%EC%83%81%EC%B1%84%ED%8C%85-%EA%B5%AC%ED%98%84-(1)">https://github.com/neocjmix/WebRTC/tree/p2p-í™”ìƒì±„íŒ…-êµ¬í˜„-(1)</a></p>

<p>ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” AWS ì„¤ì • ê³¼ì •ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ë°, ì£¼ì œ ì´ì™¸ì˜ ê¸°ìˆ ì  ë‚´ìš©ì„ ê°€ëŠ¥í•œ ë°°ì œí•˜ê¸° ìœ„í•´ì„œ ë³„ë„ì˜ frameworkì´ë‚˜
AWS CloudFormationë“±ì„ ì´ìš©í•˜ì§€ ì•Šê³  ì›¹ ì½˜ì†” ì„¤ì • í™”ë©´ì„ ìº¡ì³í•´ ë³´ì—¬ì¤„ ê²ƒì´ë‹¤. AWSì˜ API Gateway, lambda, S3ì— ëŒ€í•´ ì§€ì‹ì´ 
ìˆë‹¤ë©´ <a href="#connectionid-ê°€ì ¸ì˜¤ê¸°">AWSê´€ë ¨ ì±•í„°ë“¤ ì´í›„</a>ë¶€í„° ì½ê±°ë‚˜, ë§¨ ë§ˆì§€ë§‰ì— ìˆëŠ” ê¹ƒí—™ ì£¼ì†Œì˜ ì½”ë“œë§Œ ì°¸ì¡°í•´ë„ ë¬´ë°©í•  ë“¯ í•˜ë‹¤.</p>

<link href="/assets/toc.css" rel="stylesheet" />

<nav class="toc">
  <h2 class="no_toc" id="section">ëª©ì°¨</h2>

<ol id="markdown-toc">
  <li><a href="#tldr" id="markdown-toc-tldr">TL;DR</a></li>
  <li><a href="#êµ¬í˜„ëª©í‘œ" id="markdown-toc-êµ¬í˜„ëª©í‘œ">êµ¬í˜„ëª©í‘œ</a>    <ol>
      <li><a href="#ì¤€ë¹„í• ê²ƒ" id="markdown-toc-ì¤€ë¹„í• ê²ƒ">ì¤€ë¹„í• ê²ƒ</a></li>
    </ol>
  </li>
  <li><a href="#aws-s3" id="markdown-toc-aws-s3">AWS S3</a></li>
  <li><a href="#aws-api-gateway---websocket-api" id="markdown-toc-aws-api-gateway---websocket-api">AWS API Gateway - WebSocket API</a>    <ol>
      <li><a href="#api-í…ŒìŠ¤íŠ¸" id="markdown-toc-api-í…ŒìŠ¤íŠ¸">API í…ŒìŠ¤íŠ¸</a></li>
    </ol>
  </li>
  <li><a href="#aws-lambda" id="markdown-toc-aws-lambda">AWS Lambda</a></li>
  <li><a href="#connectionid-ê°€ì ¸ì˜¤ê¸°" id="markdown-toc-connectionid-ê°€ì ¸ì˜¤ê¸°">ConnectionId ê°€ì ¸ì˜¤ê¸°</a>    <ol>
      <li><a href="#connection-api" id="markdown-toc-connection-api">@Connection API</a></li>
    </ol>
  </li>
  <li><a href="#aws-websocketì„-í†µí•œ-ì–‘ë°©í–¥-ë©”ì„¸ì§•ìœ¼ë¡œ-signaling-êµ¬í˜„" id="markdown-toc-aws-websocketì„-í†µí•œ-ì–‘ë°©í–¥-ë©”ì„¸ì§•ìœ¼ë¡œ-signaling-êµ¬í˜„">AWS WebSocketì„ í†µí•œ ì–‘ë°©í–¥ ë©”ì„¸ì§•ìœ¼ë¡œ signaling êµ¬í˜„</a>    <ol>
      <li><a href="#êµ¬í˜„í• -websocket-api" id="markdown-toc-êµ¬í˜„í• -websocket-api">êµ¬í˜„í•  WebSocket API</a></li>
      <li><a href="#lambda-function" id="markdown-toc-lambda-function">Lambda function</a></li>
      <li><a href="#s3" id="markdown-toc-s3">S3</a></li>
    </ol>
  </li>
  <li><a href="#aws-ì„œë¹„ìŠ¤ê°„-ê¶Œí•œì„¤ì •" id="markdown-toc-aws-ì„œë¹„ìŠ¤ê°„-ê¶Œí•œì„¤ì •">AWS ì„œë¹„ìŠ¤ê°„ ê¶Œí•œì„¤ì •</a></li>
</ol>

</nav>

<h2 id="êµ¬í˜„ëª©í‘œ">êµ¬í˜„ëª©í‘œ</h2>

<p>í˜„ì¬ê¹Œì§€ ì•±ì˜ êµ¬ì„±ì„ ë³´ë©´ í•œê°œì˜ Node.js ê¸°ë°˜ WASì—ì„œ Socket.ioë¥¼ í†µí•´ ì„œë¡œ í†µì‹ í•˜ëŠ” í•œê°œì˜ signaling ì—”ë“œí¬ì¸íŠ¸ì™€ 
í•œê°œì˜ ì •ì  html í˜ì´ì§€ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. ì´ Node.js ì•±ì„ í†µì§¸ë¡œ AWS EC2ì— ì˜¬ë ¤ë„ ë³„ ë¬¸ì œ ì—†ì´ ì‘ë™ í•˜ê² ì§€ë§Œ, 
ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” serverless í™˜ê²½ìœ¼ë¡œ êµ¬ì„±í•´ë³´ê³ ì í•œë‹¤. ëª©í‘œí•˜ëŠ” êµ¬ì„±ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<table>
  <thead>
    <tr>
      <th>ë‚´ìš©</th>
      <th>as-is</th>
      <th>to-be</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>WebSocket</td>
      <td>Socket.io</td>
      <td>AWS API Gateway WebSocket API</td>
    </tr>
    <tr>
      <td>Signaling Server</td>
      <td>Node.js â€˜httpâ€™</td>
      <td>AWS lambda</td>
    </tr>
    <tr>
      <td>frontend</td>
      <td>Node.js â€˜node-staticâ€™</td>
      <td>AWS S3</td>
    </tr>
  </tbody>
</table>

<p>ë˜í•œ ë¡œì»¬ ë„¤íŠ¸ì›ì´ ì•„ë‹Œ ì¸í„°ë„· í™˜ê²½ì—ì„œ ìƒˆë¡­ê²Œ ë°œìƒí•˜ëŠ” ë¬¸ì œë“¤ì„ í•´ê²°í•˜ê³ , í™”ìƒí†µí™”ë¥¼ í•  ìƒëŒ€ë°©ì„ ì‹ë³„í•˜ëŠ” ê°„ë‹¨í•œ
ë°©ë²•ì„ êµ¬í˜„í•˜ì—¬ ì‹¤ì œ ë™ì‘ ê°€ëŠ¥í•œ ë ˆë²¨ë¡œ ë¡œì§ì„ í–¥ìƒì‹œí‚¬ ê²ƒì´ë‹¤.</p>

<h3 id="ì¤€ë¹„í• ê²ƒ">ì¤€ë¹„í• ê²ƒ</h3>

<ul>
  <li>AWS ê³„ì • : <a href="https://aws.amazon.com/ko/">AWSì›¹ì‚¬ì´íŠ¸</a> ì—ì„œ ê°€ì…. <br />
í”„ë¦¬í‹°ì–´ë¡œ ì‹œì‘í•˜ë©´ ì™ ë§Œí•œ ê¸°ëŠ¥ì€ ì ë‹¹í•œ íŠ¸ë˜í”½ í•œë„ ë‚´ì—ì„œ 12ê°œì›”ë™ì•ˆ ë¬´ë£Œì´ë‹¤.</li>
</ul>

<h2 id="aws-s3">AWS S3</h2>

<p>ì´ì „ í¬ìŠ¤íŒ…ì—ì„œë„ ê·¸ë¬ì§€ë§Œ, ì¼ë‹¨ ëˆˆì— ë³´ì´ëŠ” ê±°ë¶€í„° í•´ë³´ì.</p>

<p>(íŠ¹ë³„í•œ ì„¤ì •ì€ í•„ìš”ì—†ê¸°ë•Œë¬¸ì— S3 ì½˜ì†”ì— ìµìˆ™í•˜ì§€ ì•Šì€ ê²½ìš°ì—ë§Œ ì•„ë˜ ì„¹ì…˜ì„ í´ë¦­í•´ ì°¸ì¡°í•˜ë©´ ë˜ê² ë‹¤.)</p>
<details>
  <summary><b>ì´ì „ í”„ë¡œì íŠ¸ì˜ client ë””ë ‰í† ë¦¬ì˜ íŒŒì¼ë“¤ì„ S3 ìŠ¤í† ë¦¬ì§€ì— ì˜¬ë ¤ì„œ https í”„ë¡œí† ì½œë¡œ ì„œë¹™í•œë‹¤.</b> (ìì„¸íˆ ë³´ë ¤ë©´ í´ë¦­)</summary>

  <ol>
    <li>
      <p><a href="https://s3.console.aws.amazon.com/">AWS S3 ì½˜ì†”</a> ì— ì ‘ì†í•´ì„œ Create Bucket ë²„íŠ¼ì„ í´ë¦­í•´ ë²„í‚·ì„ í•˜ë‚˜ ë§Œë“ ë‹¤. 
  <img src="/images/webrtc/1.png" alt="step1" /></p>
    </li>
    <li>
      <p>Bucket Nameê³¼ Regionì„ ì •í•˜ê³  Nextë¥¼ í´ë¦­í•œë‹¤.
  <img src="/images/webrtc/2.png" alt="step2" width="600" /></p>
    </li>
    <li>
      <p>ì´ ë²„í‚·ì— ì˜¬ë¦¬ëŠ” ëª¨ë“  íŒŒì¼ì„ í˜¸ìŠ¤íŒ… í•  ì˜ˆì •ì´ë¯€ë¡œ ëª¨ë“  ì ‘ê·¼ì„ ì—´ì–´ì¤€ë‹¤.
  <img src="/images/webrtc/3.png" alt="step3" width="600" />
  ì´í›„ ê¸°ë³¸ê°’ìœ¼ë¡œ Nextë¥¼ ê³„ì† í´ë¦­í•´ ë²„í‚·ì„ ìƒì„±í•œë‹¤.</p>
    </li>
    <li>
      <p>ë²„í‚·ì— ë“¤ì–´ê°„ë‹¤.
  <img src="/images/webrtc/4.png" alt="step4" /></p>
    </li>
    <li>
      <p>Uploadë¥¼ í´ë¦­í•œë‹¤.
  <img src="/images/webrtc/5.png" alt="step5" />
  ë‚˜íƒ€ë‚˜ëŠ” ëª¨ë‹¬ì— <code class="language-plaintext highlighter-rouge">/client</code> ì´í•˜ ì„¸ê°œì˜ íŒŒì¼ë“¤ì„ Drag &amp; Drop
  <img src="/images/webrtc/6.png" alt="step6" width="600" />
  ì´í›„ Nextë¥¼ ê³„ì† í´ë¦­í•´ ì—…ë¡œë“œë¥¼ ë§ˆë¬´ë¦¬í•œë‹¤.</p>
    </li>
    <li>
      <p>ëª¨ë“  íŒŒì¼ì„ ì„ íƒí•´ Actions â†’ Make Public
  <img src="/images/webrtc/7.png" alt="step7" /></p>
    </li>
    <li>
      <p><code class="language-plaintext highlighter-rouge">index.html</code>ì„ í´ë¦­í•´ì„œ Overviewë¥¼ í™•ì¸í•˜ë©´ public URLì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
  <img src="/images/webrtc/8.png" alt="step8" width="600" />
  í´ë¦­í•˜ë©´ í´ë¼ì´ì–¸íŠ¸ ì•±ì„ ë¸Œë¼ìš°ì €ì— ë„ìš´ë‹¤.</p>
    </li>
  </ol>
</details>

<p>S3ë¥¼ í†µí•´ì„œ client Appì„ í˜¸ìŠ¤íŒ…í•˜ê³  ë¸Œë¼ìš°ì €ì— ë„ì›Œë³´ë©´ HTTP ì£¼ì†Œë¡œ íŠ¹ë³„í•œ ê²½ê³  ë©”ì‹œì§€ ì—†ì´ 
ì •ìƒì ìœ¼ë¡œ ì˜ ì ‘ì†ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ë°±ì—”ë“œì—ì„œ Socket.ioë¥¼ ì„œë¹™í•˜ê³  ìˆì§€ ì•Šìœ¼ë¯€ë¡œ ì •ìƒì‘ë™í•˜ì§€ 
ì•Šìœ¼ë©° ì½˜ì†”ì˜ ì—ëŸ¬ë©”ì‹œì§€ë¥¼ í™•ì¸í•˜ë©´ <code class="language-plaintext highlighter-rouge">sendMessage</code>, <code class="language-plaintext highlighter-rouge">onMessage</code>ë¥¼ êµ¬í˜„í•˜ê³  ìˆëŠ” <code class="language-plaintext highlighter-rouge">message.js</code>ì—ì„œ 
<code class="language-plaintext highlighter-rouge">socket.io</code>ë¥¼ ë¡œë”©í•  ìˆ˜ ì—†ë‹¤ëŠ” ì—ëŸ¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p><a href="#êµ¬í˜„ëª©í‘œ">êµ¬í˜„ëª©í‘œ</a> ë¥¼ ë‹¤ì‹œ í™•ì¸í•´ë³´ë©´ Socket.ioë¥¼ AWS API Gateway WebSocket APIë¡œ ë³€ê²½í•  ì˜ˆì •ì´ë¯€ë¡œ 
ë‹¤ìŒì±•í„°ì—ì„œ WebSocket endpointë¥¼ AWSì— êµ¬í˜„í•œ ë‹¤ìŒ ëŒì•„ì™€ì„œ client ì½”ë“œë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤.</p>

<h2 id="aws-api-gateway---websocket-api">AWS API Gateway - WebSocket API</h2>

<p>ì´ì œ Socket.ioì™€ httpëª¨ë“ˆì„ í†µí•´ì„œ êµ¬í˜„í–ˆë˜ signaling ì„œë²„ë¥¼ AWS API Gatewayì™€ AWS Lambda ì¡°í•©ìœ¼ë¡œ ì¬êµ¬ì„±í•œë‹¤.
AWS API GatewayëŠ” AWSì˜ ì—¬ëŸ¬ê°€ì§€ ì„œë¹„ìŠ¤ë¥¼ ì™¸ë¶€ì—ì„œ ì‘ë™í•˜ê¸° ìœ„í•œ endpointë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ì´ë‹¤. 
REST APIë¿ë§Œ ì•„ë‹ˆë¼ ì›¹ì†Œì¼“ APIë„ ìƒì„±í•  ìˆ˜ ìˆë‹¤.</p>

<details>
  <summary><b>ë¨¼ì € WebSocket endpointë¥¼ AWS API Gatewayë¥¼ í†µí•´ì„œ êµ¬ì„±í•œë‹¤.</b> (ìì„¸íˆ ë³´ë ¤ë©´ í´ë¦­)</summary>

  <ol>
    <li>
      <p><a href="https://console.aws.amazon.com/apigateway">AWS API Gateway</a>ì— ì ‘ì†í•´ì„œ Create API ë²„íŠ¼ì„ í´ë¦­í•´ 
ìƒˆë¡œìš´ endpoint êµ¬ì„±ì„ ì‹œì‘í•œë‹¤. <br />
(APIë¥¼ ìƒì„±í•œ ì ì´ ì—†ë‹¤ë©´ ê±´ë„ˆë›°ê³  ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰)
<img src="/images/webrtc/a1.png" alt="step1" /></p>
    </li>
    <li>
      <p>ì—¬ëŸ¬ API typeì¤‘ WebSocket API ë¥¼ ì„ íƒí•œë‹¤.
<img src="/images/webrtc/a2.png" alt="step2" width="600" /></p>
    </li>
    <li>
      <p>ì„ì˜ì˜ API ì´ë¦„ì„ ì§€ì •í•˜ê³  Nextë¥¼ í´ë¦­í•œë‹¤.
<img src="/images/webrtc/a3.png" alt="step3" width="600" /></p>
    </li>
    <li>
      <p>ì´ì „ í™”ë©´ì—ì„œ route selection expressionì— ì„¤ì •í–ˆë˜ <code class="language-plaintext highlighter-rouge">$request.body.action</code> ê°’ì— ë”°ë¼ ì—¬ëŸ¬ integrationìœ¼ë¡œ 
routingì„ í•  ìˆ˜ ìˆëŠ”ë° ì—¬ê¸°ì„œëŠ” ëª¨ë“  ìš”ì²­ì„ ë°›ì•„ì¤„ ë‹¨ í•œê°œì˜ integrationìœ¼ë¡œ êµ¬ì„±í•  ê²ƒì´ê¸° ë•Œë¬¸ì—
$default routeë§Œ ì¶”ê°€í•˜ê³  Nextë¥¼ í´ë¦­í•œë‹¤.  <br />
<img src="/images/webrtc/a4.png" alt="step4" width="600" /></p>
    </li>
    <li>
      <p>ì‹¤ì œ ìš”ì²­ì„ ê°€ì§€ê³  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•  integrationì„ ì„¤ì •í•´ì•¼ í•œë‹¤. 
ì›ë˜ Lambda functionê³¼ integrationí•˜ëŠ” ê²ƒì´ ëª©í‘œì¸ë°, ì•„ì§ Lambda functionì€ ì±„ ë§Œë“¤ì§€ ì•Šì•˜ë‹¤. ì¼ë‹¨ ë˜ëŠ”ëŒ€ë¡œ Mockìœ¼ë¡œ ì§„í–‰. 
<img src="/images/webrtc/a6.png" alt="step6" width="600" /></p>
    </li>
    <li>
      <p>ë°°í¬ ìŠ¤í…Œì´ì§€ë¥¼ ì •í•˜ëŠ” ë‹¨ê³„ì´ë‹¤. ê°œë°œ ìŠ¤í…Œì´ì§€ë¥¼ ë”°ë¡œ ë§Œë“ ë‹¤ëŠ”ì§€ ê·¸ëŸ°ê±¸ ìƒê°í•  ë‹¨ê³„ëŠ” ì•„ë‹ˆë‹¤. ê¸°ë³¸ê°’ìœ¼ë¡œ ì§„í–‰.
<img src="/images/webrtc/a7.png" alt="step7" width="600" />
Nextë¥¼ í´ë¦­í•˜ë©´ API ê°€ ìƒì„±ëœë‹¤.</p>
    </li>
    <li>
      <p>ì¼ë‹¨ ë°°í¬ë¥¼ í•˜ê³  ë³´ì. Actions â†’ Deploy API
<img src="/images/webrtc/a11.png" alt="step11" width="600" /></p>
    </li>
    <li>
      <p>Dashboard ì— ë“¤ì–´ê°€ ë³´ë©´
<img src="/images/webrtc/a8.png" alt="step8" width="600" />
WebSocket endpointê°€ ìƒì„±ë˜ì–´ ìˆë‹¤.
<img src="/images/webrtc/a9.png" alt="step9" width="600" /></p>
    </li>
  </ol>
</details>

<h3 id="api-í…ŒìŠ¤íŠ¸">API í…ŒìŠ¤íŠ¸</h3>

<p>ì—¬ê¸°ê¹Œì§€ ì§„í–‰í–ˆë‹¤ë©´ ë‚´ìš©ì„ ë– ë‚˜ì„œ URLì´ ìƒì„±ë˜ì—ˆìœ¼ë‹ˆ WebSocket ì—°ê²°ì€ ê°€ëŠ¥í•  ê²ƒê°™ë‹¤. 
ë¸Œë¼ìš°ì €ì—ì„œ <strong>ìƒˆíƒ­ì„ ì—´ê³ </strong>(aws ê°€ ì—´ë ¤ìˆëŠ” íƒ­ì—ì„œ í•˜ë©´ ì—ëŸ¬ê°€ ë‚œë‹¤.) ê°œë°œì ë„êµ¬ ì½˜ì†”ì°½ì— ì…ë ¥í•´ë³´ì.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ì•„ë˜ ì„¸ì¤„ì„ í•œë²ˆì— ë¶™ì—¬ë„£ëŠ”ë‹¤.</span>
<span class="kd">const</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="dl">"</span><span class="s2">wss://{apiId}.execute-api.{region}.amazonaws.com/{stage}</span><span class="dl">"</span><span class="p">);</span> <span class="c1">// ìƒì„±ëœ WebSocket URL</span>
<span class="nx">ws</span><span class="p">.</span><span class="nx">onopen</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">connected.</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">ws</span><span class="p">.</span><span class="nx">onmessage</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="c1">// connected.</span>

<span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="dl">''</span><span class="p">)</span> <span class="c1">//ëŒ€ì¶© ì•„ë¬´ ë‚´ìš©ì´ë‚˜ ë³´ë‚´ë³´ì.</span>
<span class="c1">// {"message": "Internal server error", "connectionId":"UP98SdpMIE0CJPw=", "requestId":"UP9_GH07oE0Ft9w="}</span>
</code></pre></div></div>

<p>ìœ„ ì½”ë“œëŠ” Socket.ioë¥¼ ì´ìš©í•˜ì§€ ì•Šê³  ë¸Œë¼ìš°ì € ê¸°ë³¸ APIë¥¼ ì´ìš©í•´ì„œ WebSocket ë©”ì‹œì§€ë¥¼ ì£¼ê³ ë°›ëŠ” ì½”ë“œì´ë‹¤. 
ë‚˜ì¤‘ì— í™œìš©ë˜ë‹ˆ ëˆˆì—¬ê²¨ë´ë‘ì.</p>

<p><code class="language-plaintext highlighter-rouge">wscat</code>ë¼ëŠ” CLI íˆ´ì„ ì´ìš©í•´ì„œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ë„ ìˆë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;</span> npm <span class="nb">install</span> <span class="nt">-g</span> wscat
<span class="o">&gt;</span> wscat <span class="nt">-c</span> wss://<span class="o">{</span>apiId<span class="o">}</span>.execute-api.<span class="o">{</span>region<span class="o">}</span>.amazonaws.com/<span class="o">{</span>stage<span class="o">}</span> <span class="c">## ìƒì„±ëœ WebSocket URL</span>
Connected <span class="o">(</span>press CTRL+C to quit<span class="o">)</span>
<span class="o">&gt;</span> <span class="o">{</span><span class="s2">"action"</span>:<span class="s2">"foobar"</span><span class="o">}</span>
&lt; <span class="o">{</span><span class="s2">"message"</span>: <span class="s2">"Internal server error"</span>, <span class="s2">"connectionId"</span>:<span class="s2">"UPtw1ejFoE0CFAQ="</span>, <span class="s2">"requestId"</span>:<span class="s2">"UPtxGFJ0oE0FRYA="</span><span class="o">}</span>
</code></pre></div></div>

<p>ì œëŒ€ë¡œ ëœ integrationì´ë‚˜ responseì„¤ì •ì„ í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— errorê°€ ë°œìƒí•  ê²ƒì´ë‹¤.
ì´ì œ Lambda í•¨ìˆ˜ë¥¼ ìƒì„±í•´ì„œ integration ì—°ê²°ì„ í•´ë³´ì.</p>

<h2 id="aws-lambda">AWS Lambda</h2>

<p>AWS LambdaëŠ” AWS serverless ì•„í‚¤í…ì³ì˜ í•µì‹¬ìœ¼ë¡œ ë‚´ë¶€ ì„œë¹„ìŠ¤ë‚˜ API Gatewayë¥¼ í†µí•´ í˜¸ì¶œë˜ì–´ ì¼ì •í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.
Lambda functionì€ ë§¤ë²ˆ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ”ê²ƒì´ ë¶ˆê°€ëŠ¥í•˜ë©°, 
ì´ëŠ” Stateful í”„ë¡œí† ì½œì¸ WebSocketê³¼ëŠ” ë°°ì¹˜ë˜ëŠ” ì¼ë©´ì´ ìˆì–´ ë³´ì´ì§€ë§Œ,
WebSocket APIì˜ connectionIdë¥¼ ì‚¬ìš©í•œ ì ‘ì†ì êµ¬ë¶„ ê¸°ëŠ¥ê³¼ DynamoDBë“± persistentì„œë¹„ìŠ¤ì™€ì˜ ì—°ë™ì„ í†µí•´ì„œ statefulí•œ
ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì´ë²ˆ ì±•í„°ì—ì„œëŠ” ì¼ë‹¨ ê¸°ë³¸ functionì„ ìƒì„±í•´ì„œ API Gatewayì™€ ì—°ë™í•˜ê³  ë¸Œë¼ìš°ì €ì—ì„œ connectionì„ ì´ë£¨ì–´
ë©”ì‹œì§€ë¥¼ ì£¼ê³ ë°›ëŠ”ê²ƒ ê¹Œì§€ë§Œ í•œë‹¤.</p>

<p>ì´ë¥¼ ìœ„í•´ì„œ</p>
<details>
  <summary>
<b>ìƒˆ Lambda functionì„ ì‘ì„±í•˜ê³  WebSocket API ì˜ $default route integrationì— ì„¤ì •í•œ í›„ 
integration responseë¥¼ ì¶”ê°€í•˜ê³  APIë¥¼ ë°°í¬í•œë‹¤</b> (ìì„¸íˆ ë³´ë ¤ë©´ í´ë¦­)
</summary>

  <ol>
    <li>
      <p><a href="https://console.aws.amazon.com/lambda">AWS API Lambda</a> ì— ì ‘ì†í•´ì„œ Create function ë²„íŠ¼ì„ í´ë¦­í•´ 
ìƒˆë¡œìš´ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•œë‹¤.
<img src="/images/webrtc/b1.png" alt="step1" width="600" /></p>
    </li>
    <li>ì¼ë‹¨ Hello Worldë§Œ í• ê±°ë‹ˆê¹Œ íŠ¹ë³„í•œ ì„¤ì •ì„ í•˜ì§€ ì•ŠëŠ”ë‹¤. í•¨ìˆ˜ ì´ë¦„ì„ ë„£ê³  Create function,
<img src="/images/webrtc/b2.png" alt="step2" width="600" />
ê¸°ë³¸ êµ¬í˜„ ê·¸ëŒ€ë¡œ ë‘ê³  í•¨ìˆ˜ìƒì„±ì„ ë§ˆì¹œë‹¤. ì•„ë§ˆ ì•„ë˜ì™€ ê°™ì€ ì½”ë“œê°€ ìƒì„±ë  ê²ƒì´ë‹¤.
      <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// AWS Lambda function scratch Hello World example </span>
<span class="nx">exports</span><span class="p">.</span><span class="nx">handler</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
 <span class="c1">// TODO implement</span>
 <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="p">{</span>
     <span class="na">statusCode</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
     <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="dl">'</span><span class="s1">Hello from Lambda!</span><span class="dl">'</span><span class="p">),</span>
 <span class="p">};</span>
 <span class="k">return</span> <span class="nx">response</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div>      </div>
    </li>
    <li>
      <p><a href="https://console.aws.amazon.com/apigateway">API Gateway</a> ë¡œ ëŒì•„ê°€ì„œ ì•„ê¹Œ ë§Œë“  WebSocket API $default ë¼ìš°íŠ¸ë¥¼ ì„ íƒí•œë’¤
í˜„ì¬ MOCKìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ” Integration Requestë¥¼ í´ë¦­
<img src="/images/webrtc/b3.png" alt="step3" width="600" /></p>
    </li>
    <li>
      <p>Lambda Functionì„ ì„ íƒí•˜ê³  ë°©ê¸ˆ ì‘ì„±í•œ functionì„ ê³ ë¥¸í›„ Save. 
(APIì™€ lambdaì˜ Regionì´ ì„œë¡œ ë‹¤ë¥´ë‹¤ë©´ ë²ˆê±°ë¡œìš´ ì¶”ê°€ ì„¤ì •ì´ í•„ìš”í•˜ë‹ˆ í™•ì¸í•´ë³´ê³  ê°™ì€ Regionìœ¼ë¡œ ë‹¤ì‹œ ë§Œë“ ë‹¤.)
<img src="/images/webrtc/b4.png" alt="step4" width="600" /></p>
    </li>
    <li>
      <p>integrationì—ì„œ ë¦¬í„´í•œ ê²°ê³¼ë¥¼ clientì—ê²Œ ëŒë ¤ì£¼ë ¤ë©´ integration Responseë¥¼ ì¶”ê°€í•´ì¤˜ì•¼ë§Œ í•œë‹¤. 
ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì‹¤í–‰ì´ ë˜ì§€ë§Œ í´ë¼ì´ì–¸íŠ¸ëŠ” ì•„ë¬´ëŸ° ì‘ë‹µì„ ë°›ì„ ìˆ˜ ì—†ë‹¤.
<img src="/images/webrtc/b5.png" alt="step5" width="600" /></p>
    </li>
    <li>ë§ˆì§€ë§‰ìœ¼ë¡œ ë³€ê²½ì‚¬í•­ì„ ì ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” APIë¥¼ ë°˜ë“œì‹œ ì¬ë°°í¬í•´ì•¼í•œë‹¤.
<img src="/images/webrtc/b6.png" alt="step6" width="400" /></li>
  </ol>
</details>

<p>ì—¬ê¸°ê¹Œì§€ ì§„í–‰í•œ í›„ì— ìœ„ <a href="#API-í…ŒìŠ¤íŠ¸">API í…ŒìŠ¤íŠ¸</a> ì—ì„œ ì‹¤í–‰í•œ ì ˆì°¨ë¥¼ ë‹¤ì‹œ ìˆ˜í–‰í•´ë³´ì. 
<code class="language-plaintext highlighter-rouge">Hello from Lambda!</code> ë¼ëŠ” ws ì‘ë‹µì„ í™•ì¸í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.</p>

<h2 id="connectionid-ê°€ì ¸ì˜¤ê¸°">ConnectionId ê°€ì ¸ì˜¤ê¸°</h2>

<p>ì§€ë‚œ í¬ìŠ¤íŒ…ì—ì„œ ì™„ì„±í•œ signalingì„œë²„ ì˜ˆì œì—ì„œëŠ” êµ¬í˜„ì„ ê°„ë‹¨íˆ í•˜ê¸° ìœ„í•´ì„œ ëª¨ë“  ë©”ì‹œì§€ë¥¼ broadcastingí•˜ì˜€ë‹¤. 
ì´ê²ƒì€ ì„œë²„ ë¡œì§ì„ ê·¹ë‹¨ì ìœ¼ë¡œ ì¤„ì—¬ì£¼ê¸´ í–ˆì§€ë§Œ ê²°ê³¼ì ìœ¼ë¡œëŠ” ì‹¤ì œ ì‚¬ìš©ì— í° ì œì•½ì´ ìˆëŠ” ì‹œê·¸ë„ë§ ë¡œì§ì´ì—ˆë‹¤. 
ê²Œë‹¤ê°€ socket.ioì˜ broadcastingì€ room ê¸°ëŠ¥ì„ ì´ìš©í•´ì„œ êµ¬í˜„ë˜ëŠ”ë°, í˜„ì¬ ì ‘ì†í•œ ì‚¬ìš©ìë“¤ì˜ ëª©ë¡ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œ ë©”ëª¨ë¦¬ì— stateìœ ì§€ê°€
ê°€ëŠ¥í•œ ì„œë²„ê°€ í•„ìš”í•˜ë‹¤.</p>

<p>statelessí•œ Lambda functionì—ì„œ broadcastingì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” WebSocket APIì˜ $connect $disconnect routeë¥¼ ì´ìš©í•˜ì—¬ 
ê° connectionì˜ ì„¸ì…˜ ì •ë³´ë¥¼ DynamoDBë“± persistentì„œë¹„ìŠ¤ì— ì €ì¥í•˜ëŠ” ë¡œì§ì´ í•„ìš”í•˜ë‹¤.
WebSocket APIê°€ integrationëœ Lambda functionì˜ event ì¸ìì— connectionIdë¥¼ ë„˜ê²¨ì£¼ë¯€ë¡œ ì´ë¥¼ ì´ìš©í•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì¡°ë¡œ
êµ¬í˜„í•  ìˆ˜ ìˆê² ë‹¤.</p>

<p><strong>(ì°¸ê³ ) Broadcastingì„ ìœ„í•œ ë¡œì§ êµ¬ì„±</strong></p>
<figure>
<div class="mermaid">
flowchart LR 

  subgraph Sender
    C0(connection0)
  end
  
  subgraph Recievers
    C1("connection1 (id1)") 
    C2("connection2 (id2)") 
    C3("connection3... (id3...)")  
  end
  
  subgraph "WebSocket API/$connect"
    L1("Lambda1")
    L2("Lambda1")
    L3("Lambda1")
  end
  
  P[(Persistence)]
  
  subgraph "WebSocket API/$message"
    L0("Lambda0")
  end
  
  C1 --&gt;|Id1| L1 --&gt;|Id1| P
  C2 --&gt;|Id2| L2 --&gt;|Id2| P
  C3 --&gt;|Id3...| L3 --&gt;|Id3...| P
  C0 --&gt;|message| L0 --&gt; Recievers
                  L0 --&gt; Recievers
                  L0 --&gt; Recievers
                  L0 --&gt; Recievers
                  L0 --&gt; Recievers
                  L0 --&gt; Recievers
  P -.-&gt;|"[id1, id2, id3, ...]"| L0
</div>
<figcaption>
Recieverë“¤ì´ ìì‹ ì˜ connectionIDë¥¼ persistenceì„œë¹„ìŠ¤ì— ì €ì¥í•´ë‘ë©´ <br />
Senderì—ì„œ broadcasting ìš”ì²­ì´ ìˆì„ë•Œ ì €ì¥ë˜ì–´ ìˆë˜ ëª¨ë“  connectionIDì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ëŠ” ì‹ì´ë‹¤.
</figcaption>
</figure>

<p>í•˜ì§€ë§Œ ì´ ì—°ì¬ì—ì„œ êµ¬í˜„í•˜ë ¤ê³  í•˜ëŠ”ê²ƒì€ 1:1 í†µì‹ ì´ê³  ì§€ì •ëœ ìƒëŒ€ë°©ì—ê²Œë§Œ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ë©´ ëœë‹¤.
connectionIdê°€ ì œê³µë˜ëŠ” Lambda í™˜ê²½ì—ì„œëŠ” ë¸Œë¡œë“œìºìŠ¤íŒ…ë³´ë‹¤ í›¨ì”¬ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„ê°€ëŠ¥í•˜ë‹¤.
ì´ê±¸ ì–´ë–»ê²Œ í•˜ëŠ”ì§€ëŠ” ë‚˜ì¤‘ì— êµ¬í˜„í• ë•Œ ë³´ê³  ì¼ë‹¨ ìì‹ ì˜ connectionIdë¥¼ ë°›ì•„ì™€ ë³´ì.</p>

<p>ë¨¼ì € Lambda function ì½”ë“œë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ê³  deploy ë²„íŠ¼ì„ ëˆ„ë¥¸ë‹¤.</p>

<p><strong>Lambda function</strong></p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">exports</span><span class="p">.</span><span class="nx">handler</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">statusCode</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="na">connectionId</span> <span class="p">:</span> <span class="nx">event</span><span class="p">.</span><span class="nx">requestContext</span><span class="p">.</span><span class="nx">connectionId</span> <span class="p">}),</span> <span class="c1">// connectionIdë¥¼ ë˜ëŒë ¤ì¤€ë‹¤.</span>
  <span class="p">};</span>
<span class="p">};</span>
</code></pre></div></div>

<p>ê·¸ë‹¤ìŒ socket.ioë¡œ ë˜ì–´ìˆëŠ” message.jsë¥¼ ìƒˆë¡œìš´ APIë¥¼ ì‚¬ìš©í•˜ëŠ” WebSocket ì½”ë“œë¡œ ì¬ì‘ì„± í•´ë³´ì. <a href="#API-í…ŒìŠ¤íŠ¸">API í…ŒìŠ¤íŠ¸</a>ì—ì„œ 
ì‚¬ìš©í–ˆë˜ ë¸Œë¼ìš°ì € WebSocket APIë¥¼ ì´ìš©í•´ì„œ ì‘ì„±í•œë‹¤.</p>

<p><strong>index.html</strong></p>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
<span class="nt">&lt;h2&gt;</span>ë‚´ í™”ë©´<span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">readonly</span> <span class="na">id=</span><span class="s">"localConnectionId"</span> <span class="nt">/&gt;</span> <span class="c">&lt;!--ë‚´ ConnectionIdë¥¼ í‘œì‹œí•  input--&gt;</span>
<span class="nt">&lt;video</span> <span class="na">id=</span><span class="s">"localVideo"</span> <span class="na">autoplay</span> <span class="na">width=</span><span class="s">"480px"</span> <span class="na">playsinline</span><span class="nt">&gt;&lt;/video&gt;</span>
<span class="nt">&lt;h2&gt;</span>ìƒëŒ€ë°© í™”ë©´<span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;video</span> <span class="na">id=</span><span class="s">"remoteVideo"</span> <span class="na">autoplay</span> <span class="na">width=</span><span class="s">"480px"</span> <span class="na">playsinline</span><span class="nt">&gt;&lt;/video&gt;</span>
<span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"call"</span><span class="nt">&gt;</span>ğŸ“<span class="nt">&lt;/button&gt;</span>
<span class="c">&lt;!--ì‚­ì œ &lt;script src="/socket.io/socket.io.js"&gt;&lt;/script&gt;--&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"script.js"</span> <span class="na">type=</span><span class="s">"module"</span><span class="nt">&gt;&lt;/script&gt;</span>
...
</code></pre></div></div>

<p><strong>message.js</strong></p>

<p>ì½”ë“œê°€ ê¹¨ì§€ì§€ ì•Šë„ë¡ ê¸°ì¡´ í•¨ìˆ˜ë“¤ì˜ interfaceë§Œ ìœ ì§€í•˜ê³  êµ¬í˜„ë¶€ëŠ” ì¼ë‹¨ ì‚­ì œí•œë‹¤.<br />
<code class="language-plaintext highlighter-rouge">getConnectionId</code> í•¨ìˆ˜ë¥¼ ì¶”ê°€í•œë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// WebSocket API</span>
<span class="kd">const</span> <span class="nx">WEB_SOCKET_API_URL</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://{apiId}.execute-api.{region}.amazonaws.com/{stage}</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">socket</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">WEB_SOCKET_API_URL</span><span class="p">);</span> 

<span class="c1">// ê¸°ì¡´ í•¨ìˆ˜ë“¤ ì¸í„°í˜ì´ìŠ¤ ìœ ì§€</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">sendMessage</span> <span class="o">=</span> <span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">payload</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="cm">/* ë‚˜ì¤‘ì— êµ¬í˜„ì˜ˆì • */</span><span class="p">};</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">onMessage</span> <span class="o">=</span> <span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">socket</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="cm">/* ë‚˜ì¤‘ì— êµ¬í˜„ì˜ˆì • */</span><span class="p">});</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">waitForConnected</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="nx">socket</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="nx">resolve</span><span class="p">));</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">getConnectionId</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="k">await</span> <span class="nx">waitForConnected</span><span class="p">;</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="dl">''</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">new</span> <span class="nb">Promise</span><span class="p">(</span><span class="nx">resolve</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">socket</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="nx">resolve</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">).</span><span class="nx">connectionId</span><span class="p">),</span> <span class="p">{</span><span class="na">once</span><span class="p">:</span> <span class="kc">true</span><span class="p">});</span>
  <span class="p">});</span>
<span class="p">};</span>
</code></pre></div></div>

<p><strong>script.js</strong></p>

<p>ë§¨ ì²˜ìŒì— ë‹¤ìŒ ë‚´ìš© ì¶”ê°€</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">onMessage</span><span class="p">,</span> <span class="nx">sendMessage</span><span class="p">,</span> <span class="nx">getConnectionId</span><span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./message.js</span><span class="dl">"</span><span class="p">;</span> <span class="c1">// getConnectionId import ì¶”ê°€</span>
<span class="nx">getConnectionId</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">connectionId</span> <span class="o">=&gt;</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">localConnectionId</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">connectionId</span><span class="p">);</span>
</code></pre></div></div>

<p>ìˆ˜ì •ëœ ì„¸ íŒŒì¼ì„ S3ì— ì—…ë¡œë“œ í•˜ê³  Make Publicì„ ì‹¤í–‰ í•´ì¤€ë‹¤. <code class="language-plaintext highlighter-rouge">index.html</code>ì˜ URLë¡œ ì ‘ì†í•´ë³´ë©´ ìƒˆë¡œ ì¶”ê°€ëœ inputì—
ìì‹ ì˜ connectionIdê°€ í‘œì‹œë  ê²ƒì´ë‹¤. <br />
(ì›¹ ì†Œì¼“ ì—°ê²° ì—ëŸ¬ê°€ ë‚  ê²½ìš° <code class="language-plaintext highlighter-rouge">WEB_SOCKET_API_URL</code>ì„ ì œëŒ€ë¡œ ì§€ì •í•´ì£¼ì—ˆëŠ”ì§€ Gateway Dashboardë¥¼ ë³´ê³  í™•ì¸í•´ë³´ì.)</p>

<p>ì´ connectionIdê°€ signal ì„œë²„ì—ì„œ ì¸ì‹í•˜ëŠ” í˜„ì¬ í´ë¼ì´ì–¸íŠ¸ì˜ ì£¼ì†Œë¼ê³  í•  ìˆ˜ ìˆê³ , ë‘ í´ë¼ì´ì–¸íŠ¸ ê°„ì— 
ì´ IDì •ë³´ë¥¼ ì„œë¡œ êµí™˜í•˜ë©´ signaling serverë¥¼ í†µí•´ì„œ ì„œë¡œ 1:1 ë©”ì‹œì§€ë¥¼ ì£¼ì†Œë°›ì„ ìˆ˜ ìˆë‹¤.</p>

<h3 id="connection-api">@Connection API</h3>

<p>ì—¬íƒœê¹Œì§„ í´ë¼ì´ì–¸íŠ¸ë°œ ë©”ì‹œì§€ì™€ ì´ì— ëŒ€í•œ ì‘ë‹µë§Œì´ êµ¬í˜„ë˜ì—ˆë‹¤. í•œìª½ì˜ ë©”ì‹œì§€ë¥¼ ë‹¤ë¥¸ìª½ì—ê²Œ ì „ë‹¬í•˜ë ¤ë©´ server to client
ë©”ì‹œì§€ë„ êµ¬í˜„í•´ì•¼ í•œë‹¤. ì´ì „ì— ìƒì„±í•œ WebSocket APIì˜ Dashboardë¥¼ ë‹¤ì‹œí•œë²ˆ ë´ë³´ì.
<img src="/images/webrtc/a10.png" alt="step10" /> 
Connection URL í•­ëª©ì— ìˆëŠ” URLì€ <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-how-to-call-websocket-api-connections.html">@connections API</a>
ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆëŠ” API ì£¼ì†Œì´ë‹¤. ì´ URLì— ë‹¤ìŒê³¼ ê°™ì´ ìš”ì²­ì„ ë³´ë‚´ë©´ íŠ¹ì •í•œ ConnectionIdë¥¼ í†µí•´ ì—°ê²°ëœ clientì—ê²Œ 
ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST https://<span class="o">{</span>api-id<span class="o">}</span>.execute-api.<span class="o">{</span>region<span class="o">}</span>.amazonaws.com/<span class="o">{</span>stage<span class="o">}</span>/@connections/<span class="o">{</span>connection_id<span class="o">}</span>
</code></pre></div></div>

<p>ìœ„ì˜ API referenceë¥¼ ë³´ë©´ POST ì´ì™¸ì—ë„ ë‹¤ë¥¸ methodë¥¼ í†µí•´ì„œ ì—°ê²°ì„ ëŠê±°ë‚˜ ìƒíƒœë¥¼ ì¡°íšŒí•˜ëŠ” ë“±ì˜ ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ”ê²ƒì„ 
í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<p>Lambda í•¨ìˆ˜ì—ì„œëŠ” <a href="https://www.npmjs.com/package/aws-sdk">AWS SDK</a>ë¥¼ ì´ìš©í•˜ë©´ ì¢€ë” í¸ë¦¬í•˜ë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">AWS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">aws-sdk</span><span class="dl">'</span><span class="p">);</span>
    <span class="k">new</span> <span class="nx">AWS</span>
      <span class="p">.</span><span class="nx">ApiGatewayManagementApi</span><span class="p">({</span> <span class="na">endpoint</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">event</span><span class="p">.</span><span class="nx">requestContext</span><span class="p">.</span><span class="nx">domainName</span><span class="p">}</span><span class="s2">/</span><span class="p">${</span><span class="nx">event</span><span class="p">.</span><span class="nx">requestContext</span><span class="p">.</span><span class="nx">stage</span><span class="p">}</span><span class="s2">`</span> <span class="p">})</span>
      <span class="p">.</span><span class="nx">postToConnection</span><span class="p">({</span> <span class="na">ConnectionId</span><span class="p">:</span> <span class="nx">connectionId</span><span class="p">,</span> <span class="na">Data</span><span class="p">:</span> <span class="dl">'</span><span class="s1">...</span><span class="dl">'</span><span class="p">})</span>
    <span class="p">}</span>
</code></pre></div></div>

<h2 id="aws-websocketì„-í†µí•œ-ì–‘ë°©í–¥-ë©”ì„¸ì§•ìœ¼ë¡œ-signaling-êµ¬í˜„">AWS WebSocketì„ í†µí•œ ì–‘ë°©í–¥ ë©”ì„¸ì§•ìœ¼ë¡œ signaling êµ¬í˜„</h2>

<p>ì´ì œ ë‘ í´ë¼ì´ì–¸íŠ¸ ê°„ì— connectionIdë§Œ ìˆìœ¼ë©´ ì„œë¡œ ë©”ì„¸ì§€ë¥¼ êµí™˜í•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•  ì¬ë£Œê°€ ì¤€ë¹„ë˜ì—ˆë‹¤. ì‹¤ì œ êµ¬í˜„ì„ í•´ë³´ì.</p>

<h3 id="êµ¬í˜„í• -websocket-api">êµ¬í˜„í•  WebSocket API</h3>
<ul>
  <li>ws ìš”ì²­ :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// stringified JSON
{ 
  connectionId?: string, // ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•  ìƒëŒ€ë°©ì˜ Connection Id, 
  message?: string, // ë©”ì‹œì§€ë‚´ìš©
}
</code></pre></div>    </div>
  </li>
  <li>ws ì‘ë‹µ :
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{ 
ConnectionId : string // ìê¸°ìì‹ ì˜ Connection Idë¥¼ ëŒë ¤ì¤€ë‹¤.
}
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="lambda-function">Lambda function</h3>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">AWS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">aws-sdk</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">handler</span> <span class="o">=</span> <span class="k">async</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="k">from</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">requestContext</span><span class="p">.</span><span class="nx">connectionId</span><span class="p">;</span>
  <span class="kd">const</span> <span class="nx">endpoint</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">event</span><span class="p">.</span><span class="nx">requestContext</span><span class="p">.</span><span class="nx">domainName</span><span class="p">}</span><span class="s2">/</span><span class="p">${</span><span class="nx">event</span><span class="p">.</span><span class="nx">requestContext</span><span class="p">.</span><span class="nx">stage</span><span class="p">}</span><span class="s2">`</span><span class="p">;</span>

  <span class="c1">// ìš”ì²­ body JSONì— connectionIdê°€ ìˆìœ¼ë©´ ë©”ì‹œì§€ ì „ë‹¬</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">body</span><span class="p">){</span>
    <span class="kd">const</span> <span class="p">{</span><span class="nx">connectionId</span><span class="p">,</span> <span class="nx">message</span><span class="p">}</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">connectionId</span><span class="p">){</span>
      <span class="k">await</span> <span class="k">new</span> <span class="nx">AWS</span>
        <span class="p">.</span><span class="nx">ApiGatewayManagementApi</span><span class="p">({</span> <span class="nx">endpoint</span> <span class="p">})</span>
        <span class="p">.</span><span class="nx">postToConnection</span><span class="p">({</span>
          <span class="na">ConnectionId</span><span class="p">:</span> <span class="nx">connectionId</span><span class="p">,</span>
          <span class="na">Data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="nx">message</span><span class="p">,</span> <span class="k">from</span> <span class="p">}),</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="nx">promise</span><span class="p">();</span> 
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="c1">// ìš”ì²­ connectionIdë¥¼ ë˜ëŒë ¤ì¤Œ</span>
  <span class="k">return</span> <span class="p">{</span>
    <span class="na">statusCode</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
    <span class="na">body</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="na">ConnectionId</span> <span class="p">:</span> <span class="k">from</span> <span class="p">}),</span>
  <span class="p">};</span>
<span class="p">};</span>
</code></pre></div></div>
<p>ìœ„ì™€ ê°™ì´ ì‘ì„±í•˜ê³  deploy í•œë‹¤.</p>

<h3 id="s3">S3</h3>

<p><strong>message.js</strong></p>

<p>êµ¬í˜„ì˜ˆì •ì´ì—ˆë˜ ë©”ì„¸ì§• ë¶€ë¶„ì„ êµ¬í˜„í•œë‹¤. ë©”ì‹œì§€ë¥¼ íŠ¹ì • peerì—ê²Œ ë³´ë‚´ëŠ” ë°©ì‹ìœ¼ë¡œ ë°”ë€Œì—ˆê¸° ë•Œë¬¸ì— 
ê° ë©”ì†Œë“œì˜ íŒŒë¼ë¯¸í„°ì— ìƒëŒ€ë°©ì˜ connectionIdì •ë³´ê°€ ì¶”ê°€ë˜ì–´ì•¼ í•œë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/*...*/</span>

<span class="c1">// ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìƒíƒœì˜ connectionIdë¥¼ ì¶”ê°€ë¡œ ë°›ëŠ”ë‹¤.</span>
<span class="k">export</span> <span class="kd">const</span> <span class="nx">sendMessage</span> <span class="o">=</span> <span class="p">(</span><span class="nx">connectionId</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">payload</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">socket</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
    <span class="nx">connectionId</span><span class="p">,</span>
    <span class="na">message</span><span class="p">:</span> <span class="p">{</span>
      <span class="nx">type</span><span class="p">,</span>
      <span class="nx">payload</span>
    <span class="p">}</span>
  <span class="p">}));</span>
<span class="p">};</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">onMessage</span> <span class="o">=</span> <span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">socket</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span><span class="nx">message</span><span class="p">,</span> <span class="k">from</span><span class="p">}</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">message</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="nx">type</span><span class="p">)</span> <span class="nx">callback</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">payload</span><span class="p">,</span> <span class="k">from</span><span class="p">);</span> <span class="c1">// ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì˜¨ ìƒëŒ€ì˜ connectionIdë„ ë„˜ê²¨ì¤€ë‹¤.</span>
<span class="p">});</span>

<span class="cm">/*...*/</span>
</code></pre></div></div>

<p><strong>index.html</strong></p>

<p>ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìƒëŒ€ë°©ì˜ ConnectionIdë¥¼ ì…ë ¥ë°›ì„ inputì„ ì¶”ê°€í•œë‹¤.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>...
<span class="nt">&lt;h2&gt;</span>ë‚´ í™”ë©´<span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">readonly</span> <span class="na">id=</span><span class="s">"localConnectionId"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;video</span> <span class="na">id=</span><span class="s">"localVideo"</span> <span class="na">autoplay</span> <span class="na">width=</span><span class="s">"480px"</span> <span class="na">playsinline</span><span class="nt">&gt;&lt;/video&gt;</span>
<span class="nt">&lt;h2&gt;</span>ìƒëŒ€ë°© í™”ë©´<span class="nt">&lt;/h2&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">id=</span><span class="s">"remoteConnectionId"</span> <span class="nt">/&gt;</span> <span class="c">&lt;!--ì´ ë¶€ë¶„ ì¶”ê°€--&gt;</span>
<span class="nt">&lt;video</span> <span class="na">id=</span><span class="s">"remoteVideo"</span> <span class="na">autoplay</span> <span class="na">width=</span><span class="s">"480px"</span> <span class="na">playsinline</span><span class="nt">&gt;&lt;/video&gt;</span>
<span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"call"</span><span class="nt">&gt;</span>ğŸ“<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"script.js"</span> <span class="na">type=</span><span class="s">"module"</span><span class="nt">&gt;&lt;/script&gt;</span>
...
</code></pre></div></div>

<p><strong>script.js</strong>
ìœ„ message.jsì˜ sendMessage, onMessage í•¨ìˆ˜ì˜ ë³€ê²½ëœ íŒŒë¼ë¯¸í„°ì— ë§ì¶°ì„œ í˜¸ì¶œí•¨ìˆ˜ë„ ìˆ˜ì •í•´ì¤€ë‹¤.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// íŒŒì¼ ìƒë‹¨ ì–´ë”˜ê°€ì—</span>
<span class="kd">const</span> <span class="nx">remoteConnectionId</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">remoteConnectionId</span><span class="dl">'</span><span class="p">);</span>

<span class="cm">/*...*/</span>

<span class="c1">// SDP offerë©”ì‹œì§€ ë³´ë‚´ëŠ” ë¶€ë¶„</span>
<span class="kd">const</span> <span class="nx">sendSdpOffer</span> <span class="o">=</span> <span class="k">async</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">rtcSessionDescriptionInit</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">rtcPeerConnection</span><span class="p">.</span><span class="nx">createOffer</span><span class="p">();</span>
  <span class="k">await</span> <span class="nx">rtcPeerConnection</span><span class="p">.</span><span class="nx">setLocalDescription</span><span class="p">(</span><span class="nx">rtcSessionDescriptionInit</span><span class="p">);</span>
  <span class="c1">// sendMessage í˜¸ì¶œì˜ ì²«ë²ˆì§¸ ì¸ìë¡œ ì‚¬ìš©ìë¡œë¶€í„° inputì— ì…ë ¥ë°›ì€ remoteConnectionIdë¥¼ ì¶”ê°€</span>
  <span class="nx">sendMessage</span><span class="p">(</span><span class="nx">remoteConnectionId</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span> <span class="dl">'</span><span class="s1">SDP</span><span class="dl">'</span><span class="p">,</span> <span class="nx">rtcSessionDescriptionInit</span><span class="p">)</span>
<span class="p">};</span>

<span class="cm">/* ...(ì¤‘ìš”!) ì—¬ê¸°ì— ì í˜€ìˆì§€ ì•Šì•„ë„, sendMessage í˜¸ì¶œì— remoteConnectionId.valueë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤... */</span>

<span class="c1">// SDP offer ë©”ì‹œì§€ ë°›ëŠ” ë¶€ë¶„</span>
<span class="nx">onMessage</span><span class="p">(</span><span class="dl">'</span><span class="s1">SDP</span><span class="dl">'</span><span class="p">,</span> <span class="k">async</span> <span class="p">(</span><span class="nx">descriptionInit</span><span class="p">,</span> <span class="k">from</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="c1">// callback ì‹¤í–‰ ì¸ìì— ìƒëŒ€ë°©ì˜ connectionId ì •ë³´ê°€ ì¶”ê°€ë˜ì—ˆë‹¤.</span>
  <span class="kd">const</span> <span class="nx">rtcSessionDescription</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RTCSessionDescription</span><span class="p">(</span><span class="nx">descriptionInit</span><span class="p">);</span>
  <span class="k">await</span> <span class="nx">rtcPeerConnection</span><span class="p">.</span><span class="nx">setRemoteDescription</span><span class="p">(</span><span class="nx">rtcSessionDescription</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">descriptionInit</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">offer</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// offerë¥¼ ë°›ëŠ” ì…ì¥ì—ì„œëŠ” remoteIdë¥¼ ì…ë ¥í•  inputì´ ë¹„ì–´ ìˆë‹¤.</span>
    <span class="c1">// offerë¥¼ ë³´ë‚´ì˜¨ ìƒëŒ€ë°©ì˜ idê°€ remoteId ì´ë¯€ë¡œ ì´ê²ƒìœ¼ë¡œ input ë° ë³€ìˆ˜ë¥¼ ì±„ìš°ê³  ì´í›„ í†µì‹ ì— ì‚¬ìš©í•œë‹¤.</span>
    <span class="nx">remoteConnectionId</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="k">from</span><span class="p">;</span>
    <span class="nx">callButton</span><span class="p">.</span><span class="nx">disabled</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="k">await</span> <span class="nx">sendSdpAnswer</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">})</span>
</code></pre></div></div>

<p>ê±°ì˜ ë‹¤ ë˜ì—ˆë‹¤. ì´ì œ S3 bucketì˜ index.htmlì„ ë‘ ë¸Œë¼ìš°ì €ì— ê°ê° ë„ìš´ í›„ 
í•œìª½ì˜ localConnectionIdë¥¼ ë‹¤ë¥¸ìª½ remoteConnectionIdì— ë„£ê³  call ë²„íŠ¼ì„ í´ë¦­í•´ë³´ì.</p>

<p>â€¦ì•„ë¬´ ì¼ë„ ì¼ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<p>ê°œë°œì ë„êµ¬ì˜ ë„¤íŠ¸ì›Œí¬ íƒ­ì„ í™•ì¸í•´ë³´ì.</p>

<p><img src="/images/webrtc/c1.png" alt="step1" /></p>

<p><code class="language-plaintext highlighter-rouge">internal server error</code> Lambda í•¨ìˆ˜ ì‹¤í–‰ì‹œ ë­”ê°€ ë¬¸ì œê°€ ìƒê¸´ë“¯ í•˜ë‹¤.</p>

<p>Lambda í•¨ìˆ˜ ì—ëŸ¬ë¡œê·¸ë¥¼ í™•ì¸í•˜ëŸ¬ ê°€ë³´ì.</p>

<p><img src="/images/webrtc/c2.png" alt="step2" />
<img src="/images/webrtc/c3.png" alt="step3" />
<img src="/images/webrtc/c4.png" alt="step4" /></p>

<p>Lambda í•¨ìˆ˜ê°€ @connections APIë¥¼ ì‹¤í–‰í•  ê¶Œí•œì´ ì—†ëŠ” ëª¨ì–‘ì´ë‹¤. ì¼ë‹¨ ìš”ê²ƒë§Œ í•´ê²°í•˜ë©´ ë  ê±° ê°™ë‹¤.</p>

<h2 id="aws-ì„œë¹„ìŠ¤ê°„-ê¶Œí•œì„¤ì •">AWS ì„œë¹„ìŠ¤ê°„ ê¶Œí•œì„¤ì •</h2>

<p>AWS ë‚´ë¶€ ì„œë¹„ìŠ¤ì—ì„œ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ì„œëŠ” ê¶Œí•œ ì„¤ì •ì´ í•„ìš”í•˜ë‹¤. 
ë‹¤ìŒ ì ˆì°¨ë¥¼ í†µí•´ì„œ Lambda í•¨ìˆ˜ê°€ API Gateway ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•´ì£¼ì–´ì•¼ í•œë‹¤.</p>

<details>
  <summary><b>ëŒë‹¤ í•¨ìˆ˜ì— API Gateway ê¶Œí•œ ì¶”ê°€</b> (ìì„¸íˆ ë³´ë ¤ë©´ í´ë¦­)</summary>

</details>
:ET