I"ú<h2 id="1ì¥">1ì¥</h2>

<table>
  <thead>
    <tr>
      <th>Â </th>
      <th>Â </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>.</td>
      <td>ì´ˆë‚œê° DAO</td>
    </tr>
    <tr>
      <td>í…œí”Œë¦¿ ë©”ì˜ë“œ íŒ¨í„´</td>
      <td>getConnection ì¶”ìƒ ë©”ì˜ë“œ</td>
    </tr>
    <tr>
      <td>ì „ëµíŒ¨í„´</td>
      <td>ConnectionMaker interface íŒŒë¼ë¯¸í„° DI</td>
    </tr>
    <tr>
      <td>íŒ©í† ë¦¬</td>
      <td>DaoFactory</td>
    </tr>
    <tr>
      <td>ìŠ¤í”„ë§ ë¹ˆ</td>
      <td>@Bean</td>
    </tr>
  </tbody>
</table>

<h3 id="memo">memo</h3>

<ul>
  <li>
    <p>mysql, jdbc ë³µìŠ´
 	+ resultset, connection, preparedstatement ëª¨ë‘ close í•´ì•¼ í•œë‹¤.
 	+ primary key, unique, index ê´€ê³„â€¦
 	+ ë‚´ìš©ì´ ê¸´ í•„ë“œëŠ” 1:1 í…Œì´ë¸” ë¶„ë¦¬ í•„ìˆ˜
 	+ <code class="language-plaintext highlighter-rouge">PreparedStatement ps = con.prepareStatement(sql, PreparedStatement.RETURN_GENERATED_KEYS);</code> -&gt; resultset
 	+ foreign key <code class="language-plaintext highlighter-rouge">pid INT, FOREIGN KEY (pid) REFERENCES PERSON (pid)</code>
 	+ ALTER TABLE TEXT ADD FOREIGN KEY (mid) REFERENCES MESSAGE(mid);
 	+ last_insert_id()
 	+ transaction with mysql</p>

  	```sql
  	START TRANSACTION;
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>     INSERT INTO MESSAGE (pid) VALUES (33);
     INSERT INTO TEXT (tid, content) VALUES (last_insert_id(),"asdf");
 COMMIT;
  	```
</code></pre></div>    </div>
  </li>
</ul>

 	+ transaction with jdbc	 	

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	```java
	 	try{
	 		con.setAutoCommit(false);
	 		//...do queries
			con.commit();
	 	}catch(SQLException e){
			con.rollback();
	 	}finally{
	 		con.setAutoCommit(true);
	 	}
	```
</code></pre></div></div>

<h2 id="2ì¥">2ì¥</h2>
<ul>
  <li>ì˜ˆì™¸ ë°œìƒ í…ŒìŠ¤íŠ¸ â€“&gt; <code class="language-plaintext highlighter-rouge">@Test(expected = ExpectedException.class)</code></li>
  <li>
    <p>test with spring context
 	+ Annotation ì„¤ì •</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> ```java
 @RunWith(SpringJUnit4ClassRunner.class)
 @ContextConfiguration(classes = BeanConfiguration.class, loader = AnnotationConfigContextLoader.class)
     //or
 @ContextConfiguration(location = "/applicationContext.xml")
     //or
 @ContextConfiguration
 ```
 http://blog.outsider.ne.kr/860  + ê°™ì€ ì„¤ì •íŒŒì¼ì´ë©´ ì—¬ëŸ¬ê°œì˜ Contextê°€ ë§Œë“¤ì–´ì§€ì§€ ì•Šê³  í•˜ë‚˜ë¡œ ê³µìœ ëœë‹¤.  + contextë¥¼ ë³€ê²½í•  ì‹œ í´ë˜ìŠ¤ ë˜ëŠ” ë©”ì†Œë“œì— `@DirtiesContext` , `@DirtiesContext(classMode = ClassMode.AFTER_EACH_TEST_METHOD)` ë¥¼ ì‚¬ìš©í•˜ë©´ ê³µìœ í•˜ì§€ ì•Šê³  ë‹¤ë¥¸ í…ŒìŠ¤íŠ¸ì— ì˜í–¥ì„ ë¼ì¹˜ì§€ ì•Šë„ë¡ ìƒˆë¡œ ë§Œë“¤ì–´ì¤€ë‹¤.
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="3ì¥">3ì¥</h2>

<ul>
  <li>í…œí”Œë¦¿/ì½œë°± íŒ¨í„´</li>
</ul>

<h2 id="4ì¥">4ì¥</h2>

<h3 id="ì˜ˆì™¸">ì˜ˆì™¸</h3>
<ul>
  <li>ì—ëŸ¬
 	+ ì‹œìŠ¤í…œ ì—ëŸ¬. íŠ¸ë¼ì´ìºì¹˜ë¡œ ì²˜ë¦¬ ë¶ˆê°€ëŠ¥</li>
  <li>ì˜ˆì™¸
 	+ ì–¸ì²´í¬ì˜ˆì™¸ == ëŸ°íƒ€ì„ì˜ˆì™¸ extends RuntimeException
 		* ì•ˆì¡ì•„ë„ ëŒ
 		* ì½”ë“œ ì˜ëª»
 		* NullPointerException
 		* IllegalArgumentException
 		* ê³„ì† throw í•  í•„ìš” ì—†ì´ ì¡ê³  ì‹¶ì„ë•Œë§Œ ì¡ìœ¼ë©´ ëŒ
 	+ ì²´í¬ì˜ˆì™¸ : ì¼ë°˜ì ì¸ ì˜ˆì™¸
 		* ì£¼ë¡œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ì™¸ë¶€ì˜ ì˜ˆì™¸ìƒí™©
 		* ìƒí™©ì„ ë³µêµ¬í•  ê°€ëŠ¥ì„±ì´ ìˆìŒ
 		* ê¼­ ì²˜ë¦¬í•´ì•¼í•¨
 		*  try â€¦ catch ë˜ëŠ” throw ì•ˆí•˜ë©´ ì»´íŒŒì¼ì—ëŸ¬
 		*  ìµœê·¼ ì„œë²„í™˜ê²½ì˜ í”„ë¡œê·¸ë¨ì—ì„œëŠ” í™œìš©ë„ê°€ ë–¨ì–´
 			-  ëŒ€ì‘ì´ ë¶ˆê°€ëŠ¥í•˜ë‹¤ë©´ ë¹¨ë¦¬ ëŸ°íƒ€ì„ ì˜ˆì™¸ë¡œ ì „í™˜</li>
  <li>ìŠ¤í”„ë§
 	+ SQLException.getSQLState() ëŠ” ë¶€ì •í™•í•˜ë‹¤.
 	+ SQLException â€“&gt; DataAccessException ìœ¼ë¡œ ë˜í•‘
 	+ ì‹¤ì œë¡œëŠ” DataAccesssException ë¥¼ ìƒì†í•œ ë‹¤ì–‘í•­ ì˜ˆì™¸ë¥¼ throw í•œë‹¤.
 	+ DataAccesssException
 		* DataIntegrityViolationException
 			* DuplicateKeyException - [ì£¼ì˜]JDBCì—ì„œë§Œ ë°œìƒ
 		* InvalidDataAccessResourceUsageException
 			-  BadSqlGrammarException - JDBC
 			-  HibernateQueryException - HIbernate
 			-  TypeMismatchDataAccesException
 		*  OptimisticLockingFailureException - ë‚™ê´€ì ì¸ ë½í‚¹ ì˜ˆì™¸ (ë™ì‹œ ì—…ë°ì´íŠ¸ ë°©ì§€)
 			-  ObjectOptimisticLockingFailureException
 				+  HIbernateOptimisticLockingFailureException
 				+  JdpOptimisticLockingFailureException
 		*  IncorrectResultSizeDataAccessException - queryForObject ë“±ì—ì„œ ê²°ê³¼ ê°¯ìˆ˜
 			-  EmptyReaultDataAccessException</li>
  <li>SQLExceptionìœ¼ë¡œë¶€í„° ì§ì ‘ Translation</li>
</ul>

 	```java
 	@Test(expected = DuplicateKeyExceptionException.class)
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    public void testSqlExceptionTranslate() throws Exception {
        try{
            ud.add(user1);
            ud.add(user1);
        }catch(DuplicateKeyException e){
            SQLException sqlException = (SQLException)e.getRootCause();
            SQLExceptionTranslator sqlExceptionTranslator = new SQLErrorCodeSQLExceptionTranslator(dataSource);
            DataAccessException dataAccessException = sqlExceptionTranslator.translate(null, null, sqlException);
            throw dataAccessException;
        }
    }
 	```
</code></pre></div></div>

:ET